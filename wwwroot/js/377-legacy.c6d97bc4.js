"use strict";(self["webpackChunkvue2a_test"]=self["webpackChunkvue2a_test"]||[]).push([[377],{377:function(t,e,n){n.d(e,{Z:function(){return Q}});var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{hidden:!t.visible}},[n("v-dialog",{attrs:{persistent:""},model:{value:t.openFilter,callback:function(e){t.openFilter=e},expression:"openFilter"}},[n("v-card",[n("v-card-title",[t._v("Фильтровка и сортировка")]),n("div",{staticStyle:{height:"60vh",maxheight:"60vh",overflow:"auto"}},[t.load?t._e():n("v-simple-table",{attrs:{dense:"",light:""},scopedSlots:t._u([{key:"default",fn:function(){return[n("tbody",t._l(t.OpenMapData().Fcols,(function(e,i){return n("tr",{key:e.FieldName,staticStyle:{"background-color":"white"}},[n("td",{staticStyle:{"border-bottom":"none"}},[n("v-text-field",{attrs:{label:e.FieldCaption,"append-icon":t.getIcon(e)},on:{"click:append":function(n){return t.sortChangeIndex(e,i)}},model:{value:e.FindString,callback:function(n){t.$set(e,"FindString",n)},expression:"column.FindString"}})],1),n("td",{staticStyle:{"border-bottom":"none",width:"50px"}},[t._v(" "+t._s(e.SortOrder)+" "),n("span",{attrs:{hidden:""}},[t._v(t._s(t.rangSort))]),n("span",{attrs:{hidden:""}},[t._v(t._s(t.nactord))])])])})),0)]},proxy:!0}],null,!1,283315501)})],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(e){return t.updateTab()}}},[t._v("ОК")]),n("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(e){return t.setFilter(!1)}}},[t._v("Отмена")])],1)],1)],1),n("div",{attrs:{hidden:"grid"!=t.mode}},[t.stateDrawer?t._e():n("v-toolbar",{attrs:{flat:""}},[t.nupdate>0?n("v-toolbar-title",[t._v(t._s(t.Descr))]):t._e(),n("v-spacer"),n("v-spacer"),n("v-spacer"),t.load?t._e():n("v-text-field",{attrs:{label:"Поиск",dense:"",filled:"",rounded:"","hide-details":"","prepend-inner-icon":"mdi-magnify","single-line":""},on:{input:function(e){return t.updateTab()}},model:{value:t.OpenMapData().Fcols[t.dispIndex].FindString,callback:function(e){t.$set(t.OpenMapData().Fcols[t.dispIndex],"FindString",e)},expression:"OpenMapData().Fcols[dispIndex].FindString"}}),null!=t.editid?[n("v-btn",{attrs:{icon:""},on:{click:function(e){return t.selectFinder(t.editid)}}},[n("v-icon",[t._v("mdi-check")])],1),n("v-btn",{attrs:{icon:""},on:{click:function(e){return t.clearFinder()}}},[n("v-icon",[t._v("mdi-window-close")])],1)]:t._e(),t._t("default"),n("v-menu",{attrs:{left:""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on,a=e.attrs;return[n("v-btn",t._g(t._b({attrs:{icon:""}},"v-btn",a,!1),i),[n("v-icon",[t._v("mdi-dots-vertical")])],1)]}}],null,!1,3221905750)},[n("v-list",[n("v-list-item-group",[null!=t.editid||t.load?t._e():[t.OpenMapData().DelProc?n("v-list-item",{key:"6",on:{click:function(e){return t.add()}}},[n("v-list-item-icon",[n("v-icon",[t._v("mdi-plus")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Добавить")])],1)],1):t._e(),n("v-list-item",{key:"7",on:{click:function(e){return t.edit()}}},[n("v-list-item-icon",[t.OpenMapData().EditProc?n("v-icon",[t._v("mdi-pencil")]):n("v-icon",[t._v("mdi-magnify")])],1),n("v-list-item-content",[t.OpenMapData().EditProc?n("v-list-item-title",[t._v("Редактировать")]):n("v-list-item-title",[t._v("Просмотр")])],1)],1),t.OpenMapData().DelProc?n("v-list-item",{key:"8",on:{click:function(e){return t.confirmDelete()}}},[n("v-list-item-icon",[n("v-icon",[t._v("mdi-delete")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Удалить")])],1)],1):t._e()],t.load?t._e():[n("v-list-item",{key:"1",on:{click:function(e){return t.setFilter(!0)}}},[n("v-list-item-icon",[n("v-icon",[t._v("mdi-filter-menu")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Фильтровка и сортировка")])],1)],1),n("v-list-item",{key:"2",on:{click:function(e){t.stateDrawer=!0}}},[n("v-list-item-icon",[n("v-icon",[t._v("mdi-code-tags")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Страницы")])],1)],1),n("v-list-item",{key:"0",on:{click:function(e){return t.updateTab()}}},[n("v-list-item-icon",[n("v-icon",[t._v("mdi-refresh")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Обновить")])],1)],1)],null!=t.editid||t.load?t._e():[n("v-list-item",{key:"3",on:{click:function(e){return t.csv()}}},[n("v-list-item-icon",[n("v-icon",[t._v("mdi-cloud-download")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Экспорт в CSV")])],1)],1),t.OpenMapData().KeyValue?n("v-list-item",{key:"4",on:{click:function(e){return t.openDetail()}}},[n("v-list-item-icon",[n("v-icon",[t._v("mdi-details")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Детали")])],1)],1):t._e()],t.OpenMapData().IdDeclareSet&&!t.load?n("v-list-item",{key:"5",on:{click:function(e){return t.editSetting()}}},[n("v-list-item-icon",[n("v-icon",[t._v("mdi-cog")])],1),n("v-list-item-content",[n("v-list-item-title",[t._v("Параметры")])],1)],1):t._e()],2)],1)],1)],2),t.stateDrawer?n("Pagination",{attrs:{findData:t.OpenMapData()}}):t._e(),t.load?t._e():[t._t("table",(function(){return[t.load?t._e():n("v-simple-table",{attrs:{dense:"","fixed-header":"",height:t.gridHeight},scopedSlots:t._u([{key:"default",fn:function(){return[n("thead",[n("tr",t._l(t.OpenMapData().Fcols,(function(e){return n("th",{key:e.FieldName,staticClass:"caption",staticStyle:{"background-color":"LightGrey"}},[n("br"),t._v(t._s(e.FieldCaption))])})),0)]),t.nupdate>0?n("tbody",t._l(t.OpenMapData().MainTab,(function(e,i){return n("tr",{key:i,style:{"background-color":i==t.current?t.selectedColor:"white"},on:{click:function(e){return t.handleClick(i)}}},t._l(t.OpenMapData().Fcols,(function(i){return n("td",{key:i.FieldName,staticClass:"caption"},[t._v(t._s(""==i.DisplayFormat?e[i.FieldName]:t.dateformat(e[i.FieldName],i.DisplayFormat)))])})),0)})),0):t._e()]},proxy:!0}],null,!1,1400174965)})]}))]],2),n("div",{attrs:{hidden:!("edit"==t.mode||"add"==t.mode)}},[null!=t.editid||t.load?t._e():n("Editor",{attrs:{save:t.save,closeEditor:t.closeEditor,action:t.mode,findData:t.OpenMapData(),uid:t.uid,readonly:!t.OpenMapData().EditProc}},[t._t("editor")],2)],1),n("div",{attrs:{hidden:!("setting"==t.mode)}},[t.OpenMapData().IdDeclareSet&&!t.load?n("Editor",{attrs:{save:t.saveSetting,closeEditor:t.closeEditor,action:t.mode,findData:t.OpenMapData().Setting,uid:t.uid2}}):t._e()],1)],1)},a=[],o=n(6198),r=(n(5666),n(9653),n(1249),n(8862),n(1539),n(8783),n(3948),n(285),n(1637),n(561),n(9714),n(5767)),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-toolbar",{attrs:{flat:"","max-width":"100vw"}},[n("span",{attrs:{hidden:""}},[t._v(t._s(t.$parent.action))]),t._v(" "+t._s(t.page()*t.nrows()+1)+" - "+t._s(Math.min((t.page()+1)*t.nrows(),t.count()))+" из "+t._s(t.count())+" "),n("v-spacer"),n("v-btn",{attrs:{icon:"",disabled:0===t.page()},on:{click:function(e){return t.$parent.onChangePage(0)}}},[n("v-icon",[t._v("mdi-page-first")])],1),n("v-btn",{attrs:{icon:"",disabled:0===t.page()},on:{click:function(e){t.$parent.onChangePage(t.page()-1)}}},[n("v-icon",[t._v("mdi-chevron-left")])],1),t._v(" "+t._s(t.page()+1)+" из "+t._s(Math.max(0,Math.ceil(t.count()/t.nrows())-1)+1)+" "),n("v-btn",{attrs:{icon:"",disabled:t.page()>=Math.ceil(t.count()/t.nrows())-1},on:{click:function(e){t.$parent.onChangePage(t.page()+1)}}},[n("v-icon",[t._v("mdi-chevron-right")])],1),n("v-btn",{attrs:{icon:"",disabled:t.page()>=Math.ceil(t.count()/t.nrows())-1},on:{click:function(e){t.$parent.onChangePage(Math.max(0,Math.ceil(t.count()/t.nrows())-1))}}},[n("v-icon",[t._v("mdi-page-last")])],1),n("v-btn",{attrs:{icon:""},on:{click:function(e){t.$parent.stateDrawer=!1}}},[n("v-icon",[t._v("mdi-window-close")])],1)],1)},d=[],c={name:"PaginationSmart",data:function(){return{rowsPerPage:30}},props:{findData:Object},methods:{OpenMapData:function(){return this.findData},count:function(){return this.OpenMapData().TotalTab?this.OpenMapData().TotalTab[0].n_total:0},page:function(){return this.OpenMapData().page?this.OpenMapData().page-1:0},nrows:function(){return this.OpenMapData().nrows?this.OpenMapData().nrows:30}}},l=c,u=n(1001),p=n(3453),m=n.n(p),h=n(680),f=n(6428),v=n(3631),g=n(6656),D=(0,u.Z)(l,s,d,!1,null,null,null),b=D.exports;m()(D,{VBtn:h.Z,VIcon:f.Z,VSpacer:v.Z,VToolbar:g.Z});var w=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{attrs:{hidden:"edit"!=t.mode}},[n("v-toolbar",{attrs:{dense:"",flat:""}},[n("v-toolbar-title",[t._v(t._s(t.Descr()))]),n("v-spacer"),t.readonly?t._e():n("v-btn",{attrs:{icon:""},on:{click:function(e){return t.save()}}},[n("v-icon",[t._v("mdi-check")])],1),n("v-btn",{attrs:{icon:""},on:{click:function(e){return t.closeEditor()}}},[n("v-icon",[t._v("mdi-window-close")])],1)],1),t._t("default",(function(){return[n("v-simple-table",{scopedSlots:t._u([{key:"default",fn:function(){return[t.nupdate>0&&""!=t.uid?n("tbody",[t.readonly?t._l(t.findData.Fcols,(function(e,i){return n("tr",{key:i,staticStyle:{"background-color":"white"}},[n("td",{staticStyle:{"border-bottom":"none"}},[n("v-text-field",{key:e.FieldName+t.uid,attrs:{label:e.FieldCaption,value:t.findData.WorkRow[e.FieldName],readonly:""}})],1)])})):t._l(t.findData.ReferEdit.Editors,(function(e,i){return n("tr",{key:i,staticStyle:{"background-color":"white"}},[n("td",{staticStyle:{"border-bottom":"none"}},[null==e.joinRow?n("v-text-field",{key:e.FieldName+t.uid,attrs:{label:e.FieldCaption},model:{value:t.OpenMapData().WorkRow[e.FieldName],callback:function(n){t.$set(t.OpenMapData().WorkRow,e.FieldName,n)},expression:"OpenMapData().WorkRow[column.FieldName]"}}):["Bureau.Finder"==e.joinRow.classname?n("v-text-field",{key:e.FieldName+t.uid,attrs:{label:e.FieldCaption,"append-icon":"mdi-magnify",readonly:""},on:{"click:append":function(e){return t.open(i)}},model:{value:t.OpenMapData().WorkRow[e.FieldName],callback:function(n){t.$set(t.OpenMapData().WorkRow,e.FieldName,n)},expression:"OpenMapData().WorkRow[column.FieldName]"}}):t._e(),"Bureau.GridCombo"==e.joinRow.classname?n("v-select",{key:e.FieldName+t.uid,attrs:{label:e.FieldCaption,items:e.joinRow.FindConrol.MainTab,"item-value":e.joinRow.keyField,"item-text":e.joinRow.FindConrol.DispField},on:{change:function(n){return t.sortChange(n,e)}},model:{value:t.OpenMapData().WorkRow[e.joinRow.valField],callback:function(n){t.$set(t.OpenMapData().WorkRow,e.joinRow.valField,n)},expression:"OpenMapData().WorkRow[column.joinRow.valField]"}}):t._e()]],2)])}))],2):t._e()]},proxy:!0}])})]}))],2),t.readonly?t._e():[t._l(t.findData.ReferEdit.Editors,(function(e,i){return[null!=e.joinRow?["Bureau.Finder"==e.joinRow.classname?n("Finder",{key:i,attrs:{visible:t.mode=="finder_"+i.toString(),params:e.joinRow.IdDeclare,editid:i,findData:e.joinRow.FindConrol,selectFinder:t.selectFinder,clearFinder:t.clearFinder}}):t._e()]:t._e()]}))]],2)},F=[],k={name:"EditorCore",data:function(){return{mode:"edit",mainObj:r.uW,nupdate:1}},props:{save:Function,closeEditor:Function,action:String,findData:Object,uid:String,readonly:Boolean},beforeCreate:function(){this.$options.components.Finder=n(377).Z},updated:function(){window.scroll(0,this.OpenMapData().scroll)},methods:{OpenMapData:function(){return this.findData},Descr:function(){return"add"==this.action?"Новая запись ("+this.findData.Descr+")":"edit"==this.action?this.readonly?"Просмотр ("+this.findData.Descr+")":"Редактирование ("+this.findData.Descr+")":"setting"==this.action?"Параметры ("+this.findData.Descr+")":void 0},open:function(t){this.OpenMapData().scroll=window.scrollY,this.mode="finder_"+t.toString()},selectFinder:function(t){var e=this.findData.ReferEdit.Editors[t],n=this.findData.ReferEdit.Editors[t].joinRow.FindConrol.curRow,i=e.joinRow.FindConrol.MainTab[n];for(var a in e.joinRow.fields)this.OpenMapData().WorkRow[e.joinRow.fields[a]]=i[a];this.nupdate=this.nupdate+1,this.mode="edit"},sortChange:function(t,e){var n=this;e.joinRow.FindConrol.MainTab.map((function(i){if(i[e.joinRow.keyField]==t)for(var a in e.joinRow.fields)n.OpenMapData().WorkRow[e.joinRow.fields[a]]=i[a]})),this.nupdate=this.nupdate+1},clearFinder:function(){this.mode="edit"},textChange:function(t,e){this.OpenMapData().WorkRow[e]=t}}},_=k,S=n(5340),M=n(3568),y=n(5978),R=n(7921),O=(0,u.Z)(_,w,F,!1,null,null,null),T=O.exports;m()(O,{VBtn:h.Z,VIcon:f.Z,VSelect:S.Z,VSimpleTable:M.Z,VSpacer:v.Z,VTextField:y.Z,VToolbar:g.Z,VToolbarTitle:R.qW});var x={name:"FinderCore",components:{Pagination:b,Editor:T},data:function(){return{mainObj:r.uW,openMap:r.M8,load:!0,mode:"grid",Descr:"Загрузка...",current:0,stateDrawer:!1,action:1,nupdate:1,nadd:1,nactord:1,items:["Нет","ASC","DESC"],rangSort:0,uid:"xx",uid2:"yy",selectedColor:r.uW.selectedColor,openFilter:!1,dispIndex:0,gridHeight:r.uW.gridHeight()}},props:{visible:{type:Boolean,required:!0},id:String,params:String,editid:Number,findData:Object,selectFinder:Function,clearFinder:Function},computed:{finderRowStyle:function(){}},methods:{resize:function(){this.gridHeight=r.uW.gridHeight()},sortChange:function(t,e){var n=0,i=this.OpenMapData().Fcols;i.map((function(t,i){"Нет"==t.Sort&&(t.SortOrder=null),i!=e&&t.SortOrder&&t.SortOrder>n&&(n=t.SortOrder)})),i[e].SortOrder=n+1,this.rangSort=n+1,this.nactord=this.nactord+1},sortChangeIndex:function(t,e){"ASC"==t.Sort?t.Sort="DESC":"DESC"==t.Sort?t.Sort="Нет":t.Sort="ASC",this.sortChange(null,e)},getIcon:function(t){return"ASC"==t.Sort?"mdi-arrow-down":"DESC"==t.Sort?"mdi-arrow-up":"mdi-sort"},dateformat:function(t,e){return r.uW.dateformat(t,e)},OpenMapData:function(){return null!=this.id?(null==r.M8.get(this.id)&&r.M8.set(this.id,{Control:null,Params:this.params,SQLParams:null,data:{}}),r.M8.get(this.id).data):this.findData},OpenMapId:function(){return null==r.M8.get(this.id)&&r.M8.set(this.id,{Control:null,Params:this.params,SQLParams:null,data:{}}),r.M8.get(this.id)},setLoad:function(t){this.load=t},setFilter:function(t){this.openFilter=t},handleClick:function(t){this.OpenMapData().curRow==t?(this.current=t,null==this.editid?this.OpenMapData().EditProc?this.edit():this.OpenMapData().KeyValue?this.openDetail():this.edit():this.selectFinder(this.editid)):(this.OpenMapData().curRow=t,this.current=t)},openDetail:function(){var t=this.OpenMapData();if(null!=t.curRow){var e,n,i,a=t.MainTab[t.curRow],o={};if(a["iddeclare"]&&a["keyf"]){var s=a["keyf"],d=a["dispfield"],c=a["iddeclare"];e=a[s],o[s]=e,n=c,i=a[d]}else e=a[t.KeyF],o[t.KeyF]=e,n=t.KeyValue,i=a[t.DispField];var l={Control:null,Params:n,TextParams:o,title:i,data:{}},u=this.id+"_"+a[t.KeyF];null==r.M8.get(u)&&r.M8.set(u,l),this.$router.push({path:"/account/finder",query:{id:u,params:n}})}},csv:function(){var t=r.FH+"React/csv",e=new FormData,n=this.OpenMapData(),i=this.params;e.append("id",i),e.append("Fc",JSON.stringify(n.Fcols)),n.SQLParams&&e.append("SQLParams",JSON.stringify(n.SQLParams)),n.TextParams&&e.append("TextParams",JSON.stringify(n.TextParams)),fetch(t,{method:"POST",mode:r.W6?"no-cors":"cors",cache:"no-cache",credentials:r.W6?"include":"omit",body:e}).then((function(t){return t.blob()})).then((function(t){var e=document.createElement("a");e.href=URL.createObjectURL(t),e.setAttribute("download","data.csv"),e.click()}))},loadFile:function(){var t=this.OpenMapData();if(null!=t.curRow){var e=t.MainTab[t.curRow],n=this.params,i="F"+n+"_"+e[t.KeyF],a=t.Descr+", "+e[t.DispField],o=r.FH+"Docfiles/dir?id="+i+"/&caption="+a;this.$refs.fileLink2.href=o,this.$refs.fileLink2.click()}},confirmDelete:function(){var t=this.OpenMapData();if(null!=t.curRow){var e=t.MainTab[t.curRow],n=e[t.DispField];r.uW.confirm(this.Descr,"Удалить запись '"+n+"'?",this.rowDelete)}},rowDelete:function(){var t=(0,o.Z)(regeneratorRuntime.mark((function t(){var e,n,i,a,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.OpenMapData(),n={},n[e.KeyF]=e.MainTab[e.curRow][e.KeyF],e.DelProc.toLowerCase().indexOf("_del_1")>-1&&(n["AUDTUSER"]=e.Account),i=r.FH+"React/exec",a=new FormData,a.append("EditProc",e.DelProc),a.append("SQLParams",JSON.stringify(n)),a.append("KeyF",e.KeyF),t.next=11,fetch(i,{method:"POST",mode:r.W6?"no-cors":"cors",cache:"no-cache",credentials:r.W6?"include":"omit",body:a});case 11:return o=t.sent,t.next=14,o.json();case 14:if(s=t.sent,"OK"==s.message||"Invalid storage type: DBNull."==s.message){t.next=18;break}return r.uW.alert("Ошибка",s.message),t.abrupt("return");case 18:e.MainTab.splice(e.curRow,1),this.nupdate=this.nupdate+1,null!=r.M8.get(this.id).updateTab&&r.M8.get(this.id).updateTab();case 21:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),onChangePage:function(t){this.action=this.action+1,this.OpenMapData().page=t+1,this.updateTab()},updateTab:function(){var t=(0,o.Z)(regeneratorRuntime.mark((function t(){var e,n,i,a,o,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=r.FH+"React/FinderStart",n=new FormData,i=this.OpenMapData(),a=this.params,n.append("id",a),n.append("mode","data"),n.append("page",i.page.toString()),n.append("Fc",JSON.stringify(i.Fcols)),i.SQLParams&&n.append("SQLParams",JSON.stringify(i.SQLParams)),i.TextParams&&n.append("TextParams",JSON.stringify(i.TextParams)),t.next=12,fetch(e,{method:"POST",mode:r.W6?"no-cors":"cors",cache:"no-cache",credentials:r.W6?"include":"omit",body:n});case 12:return o=t.sent,t.next=15,o.json();case 15:s=t.sent,s.Error?r.uW.alert("Ошибка",s.Error):(i.MainTab=s.MainTab,i.TotalTab=s.TotalTab,i.page=s.page,this.mode,this.mode="grid",this.nupdate=this.nupdate+1,this.openFilter=!1,null!=r.M8.get(this.id).updateTab&&r.M8.get(this.id).updateTab());case 17:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),saveSetting:function(){var t=this.OpenMapData().Setting,e=t.MainTab[0];t.ColumnTab.map((function(n){e[n]=t.WorkRow[n]}));var n=this.OpenMapData();t.ReferEdit.SaveFieldList.map((function(e){n.SQLParams["@"+e]=t.MainTab[0][e]})),this.updateTab()},save:function(){var t=(0,o.Z)(regeneratorRuntime.mark((function t(){var e,n,i,a,o,s,d,c,l,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(n in e=this.OpenMapData(),e.DefaultValues)e.WorkRow[n]=e.DefaultValues[n];for(i in e.TextParams)e.WorkRow[i]=e.TextParams[i];return a={},e.ReferEdit.SaveFieldList.map((function(t){a[t]=e.WorkRow[t]})),o=r.FH+"React/exec",s=new FormData,s.append("EditProc",e.EditProc),s.append("SQLParams",JSON.stringify(a)),s.append("KeyF",e.KeyF),t.next=12,fetch(o,{method:"POST",mode:r.W6?"no-cors":"cors",cache:"no-cache",credentials:r.W6?"include":"omit",body:s});case 12:return d=t.sent,t.next=15,d.json();case 15:if(c=t.sent,"OK"==c.message){t.next=21;break}return r.uW.alert("Ошибка",c.message),t.abrupt("return");case 21:1==c.ColumnTab.length?e.WorkRow[e.KeyF]=c.MainTab[0][c.ColumnTab[0]]:c.ColumnTab.map((function(t){e.WorkRow[t]=c.MainTab[0][t]}));case 22:l={},"edit"==this.mode&&(u=e.curRow,l=e.MainTab[u]),e.ColumnTab.map((function(t){l[t]=e.WorkRow[t]})),"add"==this.mode&&e.MainTab.push(l),this.mode="grid",this.nupdate=this.nupdate+1,null!=r.M8.get(this.id).updateTab&&r.M8.get(this.id).updateTab();case 29:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),closeEditor:function(){this.mode="grid"},add:function(){var t=this.OpenMapData();null==t.WorkRow&&(t.WorkRow={}),t.ColumnTab.map((function(e){t.WorkRow[e]=""})),this.nadd=this.nadd+1,this.uid="uid"+this.nadd.toString(),this.mode="add"},edit:function(){var t=this,e=this.OpenMapData();null==e.WorkRow&&(e.WorkRow={});var n=e.curRow,i=e.MainTab[n];e.ColumnTab.map((function(t){e.WorkRow[t]=null==i[t]?"":i[t]})),e.Fcols.map((function(n){""!=n.DisplayFormat&&(e.WorkRow[n.FieldName]=t.dateformat(e.WorkRow[n.FieldName],n.DisplayFormat))})),this.nadd=this.nadd+1,this.uid="uid"+this.nadd.toString(),this.mode="edit"},editSetting:function(){var t=this,e=this.OpenMapData().Setting;e.WorkRow={};var n=e.MainTab[0];e.ColumnTab.map((function(t){e.WorkRow[t]=null==n[t]?"":n[t]})),e.Fcols.map((function(n){""!=n.DisplayFormat&&(e.WorkRow[n.FieldName]=t.dateformat(e.WorkRow[n.FieldName],n.DisplayFormat))})),this.nadd=this.nadd+1,this.uid2="uid2"+this.nadd.toString(),this.mode="setting"}},mounted:function(){var t=(0,o.Z)(regeneratorRuntime.mark((function t(){var e,n,i,a,o,s,d,c,l,u,p,m=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=this.OpenMapData,n=this.OpenMapId,i=this.setLoad,a=this.editid,o=this.params,null==a){t.next=15;break}return s=e(),null==s.curRow&&(s.curRow=0),this.current=s.curRow,this.Descr=s.Descr+" (выбор)",s.Fcols.map((function(t,e){t.FieldName==s.DispField&&(m.dispIndex=e)})),s.resize=this.resize,window.addEventListener("resize",(function(){s.resize&&s.resize()}),!0),i(!1),t.abrupt("return");case 15:if(d=n(),d.handleClick=this.handleClick,d.resize=this.resize,null!=d.data.Descr){t.next=39;break}return c=r.FH+"React/FinderStart",l=new FormData,l.append("id",o),d.SQLParams&&l.append("SQLParams",JSON.stringify(d.SQLParams)),d.TextParams&&l.append("TextParams",JSON.stringify(d.TextParams)),t.next=26,fetch(c,{method:"POST",mode:r.W6?"no-cors":"cors",cache:"no-cache",credentials:r.W6?"include":"omit",body:l});case 26:return u=t.sent,t.next=29,u.json();case 29:if(p=t.sent,!p.Error){t.next=35;break}return r.uW.alert("Ошибка",p.Error),t.abrupt("return");case 35:p.curRow=0,p.WorkRow={},p.ColumnTab.map((function(t){p.WorkRow[t]=""}));case 38:d.data=p;case 39:d.data.Fcols.map((function(t,e){t.FieldName==d.data.DispField&&(m.dispIndex=e)})),this.Descr=d.data.Descr,d.title&&(this.Descr=this.Descr+" ("+d.title+")"),this.current=d.data.curRow,i(!1);case 44:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},C=x,W=C,P=n(3237),E=n(7118),V=n(4497),N=n(6816),Z=n(7620),j=n(1317),L=n(3249),I=n(459),$=n(6768),K=(0,u.Z)(W,i,a,!1,null,"331b0b00",null),Q=K.exports;m()(K,{VBtn:h.Z,VCard:P.Z,VCardActions:E.h7,VCardTitle:E.EB,VDialog:V.Z,VIcon:f.Z,VList:N.Z,VListItem:Z.Z,VListItemContent:j.km,VListItemGroup:L.Z,VListItemIcon:I.Z,VListItemTitle:j.V9,VMenu:$.Z,VSimpleTable:M.Z,VSpacer:v.Z,VTextField:y.Z,VToolbar:g.Z,VToolbarTitle:R.qW})}}]);
//# sourceMappingURL=377-legacy.c6d97bc4.js.map