var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var h=a[e];if(b.call(c,h,e,a))return{i:e,v:h}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){a=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,a];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");
$.fn.pagination&&($.fn.pagination.defaults.beforePageText="\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430",$.fn.pagination.defaults.afterPageText="\u0438\u0437 {pages}",$.fn.pagination.defaults.displayMsg="\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 {from} \u0434\u043e {to} \u0438\u0437 {total} \u0437\u0430\u043f\u0438\u0441\u0435\u0439");$.fn.datagrid&&($.fn.datagrid.defaults.loadMsg="\u041e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u0442\u0441\u044f, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430 \u0436\u0434\u0438\u0442\u0435 ...");
$.fn.treegrid&&$.fn.datagrid&&($.fn.treegrid.defaults.loadMsg=$.fn.datagrid.defaults.loadMsg);$.messager&&($.messager.defaults.ok="\u041e\u043a",$.messager.defaults.cancel="\u0417\u0430\u043a\u0440\u044b\u0442\u044c");$.map("validatebox textbox passwordbox filebox searchbox combo combobox combogrid combotree datebox datetimebox numberbox spinner numberspinner timespinner datetimespinner".split(" "),function(a){$.fn[a]&&($.fn[a].defaults.missingMessage="\u042d\u0442\u043e \u043f\u043e\u043b\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e.")});
$.fn.validatebox&&($.fn.validatebox.defaults.rules.email.message="\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430 \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 e-mail \u0430\u0434\u0440\u0435\u0441.",$.fn.validatebox.defaults.rules.url.message="\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430 \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 URL.",$.fn.validatebox.defaults.rules.length.message=
"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430 \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0437\u0430\u0447\u0435\u043d\u0438\u0435 \u043c\u0435\u0436\u0434\u0443 {0} \u0438 {1}.",$.fn.validatebox.defaults.rules.remote.message="\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430 \u0438\u0441\u043f\u0440\u0430\u0432\u0442\u0435 \u044d\u0442\u043e \u043f\u043e\u043b\u0435.");
$.fn.calendar&&($.fn.calendar.defaults.firstDay=1,$.fn.calendar.defaults.weeks="\u0412\u041f\u0412\u0421\u0427\u041f\u0421".split(""),$.fn.calendar.defaults.months="\u042f\u043d\u0432 \u0424\u0435\u0432 \u041c\u0430\u0440 \u0410\u043f\u0440 \u041c\u0430\u0439 \u0418\u044e\u043d \u0418\u044e\u043b \u0410\u0432\u0433 \u0421\u0435\u043d \u041e\u043a\u0442 \u041d\u043e\u044f \u0414\u0435\u043a".split(" "));
$.fn.datebox&&($.fn.datebox.defaults.currentText="\u0421\u0435\u0433\u043e\u0434\u043d\u044f",$.fn.datebox.defaults.closeText="\u0417\u0430\u043a\u0440\u044b\u0442\u044c",$.fn.datebox.defaults.okText="\u041e\u043a");$.fn.datetimebox&&$.fn.datebox&&$.extend($.fn.datetimebox.defaults,{currentText:$.fn.datebox.defaults.currentText,closeText:$.fn.datebox.defaults.closeText,okText:$.fn.datebox.defaults.okText});(function(a){function b(b){return a(b).data("treegrid")?"treegrid":"datagrid"}function c(b,c){function d(b){var c=0;a(b).children(":visible").each(function(){c+=a(this)._outerWidth()});return c}var g=!1,n=a(b),f=n.datagrid("getPanel").find("div.datagrid-header"),e=f.find(".datagrid-header-row:not(.datagrid-filter-row)");(c?f.find('.datagrid-filter[name="'+c+'"]'):f.find(".datagrid-filter")).each(function(){var b=a(this).attr("name"),c=n.datagrid("getColumnOption",b),f=a(this).closest("div.datagrid-filter-c"),
r=f.find("a.datagrid-filter-btn");b=e.find('td[field="'+b+'"] .datagrid-cell')._outerWidth();b!=d(f)&&this.filter.resize(this,b-r._outerWidth());f.width()>c.boxWidth+c.deltaWidth-1&&(c.boxWidth=f.width()-c.deltaWidth+1,c.width=c.boxWidth+c.deltaWidth,g=!0)});g&&a(b).datagrid("fixColumnSize")}function d(b,c){return a(b).datagrid("getPanel").find("div.datagrid-header").find('tr.datagrid-filter-row td[field="'+c+'"] .datagrid-filter')}function e(c,d){var g=b(c);c=a(c)[g]("options").filterRules;for(g=
0;g<c.length;g++)if(c[g].field==d)return g;return-1}function h(c,g){var f=b(c);f=a(c)[f]("options");var n=f.filterRules;if("nofilter"==g.op)l(c,g.field);else{var h=e(c,g.field);0<=h?a.extend(n[h],g):n.push(g)}c=d(c,g.field);c.length&&("nofilter"!=g.op&&(n=c.val(),c.data("textbox")&&(n=c.textbox("getText")),n!=g.value&&c[0].filter.setValue(c,g.value)),c=c[0].menu)&&(c.find("."+f.filterMenuIconCls).removeClass(f.filterMenuIconCls),g=c.menu("findItem",f.operators[g.op].text),c.menu("setIcon",{target:g.target,
iconCls:f.filterMenuIconCls}))}function l(c,g){function f(a){for(var b=0;b<a.length;b++){var g=d(c,a[b]);g.length&&(g[0].filter.setValue(g,""),(g=g[0].menu)&&g.find("."+r.filterMenuIconCls).removeClass(r.filterMenuIconCls))}}var n=b(c),h=a(c),r=h[n]("options");g?(n=e(c,g),0<=n&&r.filterRules.splice(n,1),f([g])):(r.filterRules=[],g=h.datagrid("getColumnFields",!0).concat(h.datagrid("getColumnFields")),f(g))}function k(c){var d=b(c),g=a.data(c,d),f=g.options;if(f.remoteFilter)a(c)[d]("load");else"scrollview"==
f.view.type&&g.data.firstRows&&g.data.firstRows.length&&(g.data.rows=g.data.firstRows),a(c)[d]("getPager").pagination("refresh",{pageNumber:1}),a(c)[d]("options").pageNumber=1,a(c)[d]("loadData",g.filterSource||g.data)}function m(b,c,d){var g=a(b).treegrid("options");if(!c||!c.length)return[];var f=[];a.map(c,function(a){a._parentId=d;f.push(a);f=f.concat(m(b,a.children,a[g.idField]))});a.map(f,function(a){a.children=void 0});return f}function p(c,d){function g(a){for(var b=[],c=n.pageNumber;0<c;){b=
(c-1)*parseInt(n.pageSize);var d=b+parseInt(n.pageSize);b=a.slice(b,d);if(b.length)break;c--}return{pageNumber:0<c?c:1,rows:b}}var f=b(this),e=a.data(this,f),n=e.options;"datagrid"==f&&a.isArray(c)?c={total:c.length,rows:c}:"treegrid"==f&&a.isArray(c)&&(c=m(this,c,d),c={total:c.length,rows:c});if(!n.remoteFilter){if(e.filterSource)if(n.isSorting)n.isSorting=void 0;else if("datagrid"==f)e.filterSource=c;else{if(e.filterSource.total+=c.length,e.filterSource.rows=e.filterSource.rows.concat(c.rows),d)return n.filterMatcher.call(this,
c)}else e.filterSource=c;if(!n.remoteSort&&n.sortName){var h=n.sortName.split(","),r=n.sortOrder.split(","),k=a(this);e.filterSource.rows.sort(function(a,b){for(var c=0,d=0;d<h.length;d++){c=h[d];var g=r[d];c=(k.datagrid("getColumnOption",c).sorter||function(a,b){return a==b?0:a>b?1:-1})(a[c],b[c])*("asc"==g?1:-1);if(0!=c)break}return c})}c=n.filterMatcher.call(this,{total:e.filterSource.total,rows:e.filterSource.rows,footer:e.filterSource.footer||[]});if(n.pagination){k=a(this);var l=k[f]("getPager");
l.pagination({onSelectPage:function(a,b){n.pageNumber=a;n.pageSize=b;l.pagination("refresh",{pageNumber:a,pageSize:b});k[f]("loadData",e.filterSource)},onBeforeRefresh:function(){k[f]("reload");return!1}});if("datagrid"==f)d=g(c.rows),n.pageNumber=d.pageNumber,c.rows=d.rows;else{var q=[],t=[];a.map(c.rows,function(a){a._parentId?t.push(a):q.push(a)});c.total=q.length;d=g(q);n.pageNumber=d.pageNumber;c.rows=d.rows.concat(t)}}a.map(c.rows,function(a){a.children=void 0})}return c}function f(d,g){function f(b){var g=
m.dc,f=a(d).datagrid("getColumnFields",b);b&&l.rownumbers&&f.unshift("_");g=(b?g.header1:g.header2).find("table.datagrid-htable");g.find(".datagrid-filter").each(function(){this.filter.destroy&&this.filter.destroy(this);this.menu&&a(this.menu).menu("destroy")});g.find("tr.datagrid-filter-row").remove();b=a('<tr class="datagrid-header-row datagrid-filter-row"></tr>');"bottom"==l.filterPosition?b.appendTo(g.find("tbody")):b.prependTo(g.find("tbody"));l.showFilterBar||b.hide();for(g=0;g<f.length;g++){var h=
f[g],k=a(d).datagrid("getColumnOption",h),q=a("<td></td>").attr("field",h).appendTo(b);k&&k.hidden&&q.hide();if("_"!=h&&(!k||!k.checkbox&&!k.expander)){if(k=n(h))a(d)[r]("destroyFilter",h);else k=a.extend({},{field:h,type:l.defaultFilterType,options:l.defaultFilterOptions});var v=l.filterCache[h];if(v)v.appendTo(q);else{v=a('<div class="datagrid-filter-c"></div>').appendTo(q);q=l.filters[k.type];var t=q.init(v,a.extend({height:24},k.options||{}));t.addClass("datagrid-filter").attr("name",h);t[0].filter=
q;t[0].menu=e(v,k.op);k.options?k.options.onInit&&k.options.onInit.call(t[0],d):l.defaultFilterOptions.onInit.call(t[0],d);l.filterCache[h]=v;c(d,h)}}}}function e(b,c){if(!c)return null;var g=a('<a class="datagrid-filter-btn">&nbsp;</a>').addClass(l.filterBtnIconCls);"right"==l.filterBtnPosition?g.appendTo(b):g.prependTo(b);var f=a("<div></div>").appendTo("body");a.map(["nofilter"].concat(c),function(b){var c=l.operators[b];c&&a("<div></div>").attr("name",b).html(c.text).appendTo(f)});f.menu({alignTo:g,
onClick:function(b){var c=a(this).menu("options").alignTo,g=c.closest("td[field]"),f=g.attr("field");g=g.find(".datagrid-filter");g=g[0].filter.getValue(g);0!=l.onClickMenu.call(d,b,c,f)&&(h(d,{field:f,op:b.name,value:g}),k(d))}});g[0].menu=f;g.bind("click",{menu:f},function(b){a(this.menu).menu("show");return!1});return f}function n(a){for(var b=0;b<g.length;b++){var c=g[b];if(c.field==a)return c}return null}g=g||[];var r=b(d),m=a.data(d,r),l=m.options;l.filterRules.length||(l.filterRules=[]);l.filterCache=
l.filterCache||{};var q=a.data(d,"datagrid").options,t=q.onResize;q.onResize=function(a,b){c(d);t.call(this,a,b)};var u=q.onBeforeSortColumn;q.onBeforeSortColumn=function(a,b){a=u.call(this,a,b);0!=a&&(l.isSorting=!0);return a};var z=l.onResizeColumn;l.onResizeColumn=function(b,g){var f=a(this).datagrid("getPanel").find(".datagrid-header .datagrid-filter-c"),e=f.find(".datagrid-filter:focus");f.hide();a(d).datagrid("fitColumns");l.fitColumns?c(d):c(d,b);f.show();e.blur().focus();z.call(d,b,g)};var y=
l.onBeforeLoad;l.onBeforeLoad=function(a,b){a&&(a.filterRules=l.filterStringify(l.filterRules));b&&(b.filterRules=l.filterStringify(l.filterRules));b=y.call(this,a,b);if(0!=b&&l.url)if("datagrid"==r)m.filterSource=null;else if("treegrid"==r&&m.filterSource)if(a){a=a[l.idField];for(var c=m.filterSource.rows||[],d=0;d<c.length;d++)if(a==c[d]._parentId)return!1}else m.filterSource=null;return b};l.loadFilter=function(a,b){a=l.oldLoadFilter.call(this,a,b);return p.call(this,a,b)};m.dc.view2.children(".datagrid-header").unbind(".filter").bind("focusin.filter",
function(b){var c=a(this);setTimeout(function(){m.dc.body2._scrollLeft(c._scrollLeft())},0)});a("#datagrid-filter-style").length||a("head").append('<style id="datagrid-filter-style">a.datagrid-filter-btn{display:inline-block;width:22px;height:22px;margin:0;vertical-align:top;cursor:pointer;opacity:0.6;filter:alpha(opacity=60);}a:hover.datagrid-filter-btn{opacity:1;filter:alpha(opacity=100);}.datagrid-filter-row .textbox,.datagrid-filter-row .textbox .textbox-text{-moz-border-radius:0;-webkit-border-radius:0;border-radius:0;}.datagrid-filter-row input{margin:0;-moz-border-radius:0;-webkit-border-radius:0;border-radius:0;}.datagrid-filter-c{overflow:hidden}.datagrid-filter-cache{position:absolute;width:10px;height:10px;left:-99999px;}</style>');
f(!0);f();l.fitColumns&&setTimeout(function(){c(d)},0);a.map(l.filterRules,function(a){h(d,a)})}var u=a.fn.datagrid.methods.autoSizeColumn,w=a.fn.datagrid.methods.loadData,x=a.fn.datagrid.methods.appendRow,g=a.fn.datagrid.methods.deleteRow;a.extend(a.fn.datagrid.methods,{autoSizeColumn:function(b,d){return b.each(function(){var b=a(this).datagrid("getPanel").find(".datagrid-header .datagrid-filter-c");b.css({width:"1px",height:0});u.call(a.fn.datagrid.methods,a(this),d);b.css({width:"",height:""});
c(this,d)})},loadData:function(b,c){b.each(function(){a.data(this,"datagrid").filterSource=null});return w.call(a.fn.datagrid.methods,b,c)},appendRow:function(b,c){var d=x.call(a.fn.datagrid.methods,b,c);b.each(function(){var b=a(this).data("datagrid");b.filterSource&&(b.filterSource.total++,b.filterSource.rows!=b.data.rows&&b.filterSource.rows.push(c))});return d},deleteRow:function(b,c){b.each(function(){var b=a(this).data("datagrid"),d=b.options;if(b.filterSource&&d.idField)if(b.filterSource.rows==
b.data.rows)b.filterSource.total--;else for(var g=0;g<b.filterSource.rows.length;g++)if(b.filterSource.rows[g][d.idField]==b.data.rows[c][d.idField]){b.filterSource.rows.splice(g,1);b.filterSource.total--;break}});return g.call(a.fn.datagrid.methods,b,c)}});var t=a.fn.treegrid.methods.loadData,q=a.fn.treegrid.methods.append,y=a.fn.treegrid.methods.insert,z=a.fn.treegrid.methods.remove;a.extend(a.fn.treegrid.methods,{loadData:function(b,c){b.each(function(){a.data(this,"treegrid").filterSource=null});
return t.call(a.fn.treegrid.methods,b,c)},append:function(b,c){return b.each(function(){var b=a(this).data("treegrid");if(b.options.oldLoadFilter){var d=m(this,c.data,c.parent);b.filterSource.total+=d.length;b.filterSource.rows=b.filterSource.rows.concat(d);a(this).treegrid("loadData",b.filterSource)}else q(a(this),c)})},insert:function(b,c){return b.each(function(){var b=a(this).data("treegrid"),d=b.options;if(d.oldLoadFilter){a:{var g=b.filterSource.rows;for(var f=0;f<g.length;f++)if(g[f][d.idField]==
(c.before||c.after)){g=f;break a}g=-1}d=m(this,[c.data],0<=g?b.filterSource.rows[g]._parentId:null);g=b.filterSource.rows.splice(0,0<=g?c.before?g:g+1:b.filterSource.rows.length);g=g.concat(d);g=g.concat(b.filterSource.rows);b.filterSource.total+=d.length;b.filterSource.rows=g;a(this).treegrid("loadData",b.filterSource)}else y(a(this),c)})},remove:function(b,c){b.each(function(){var b=a(this).data("treegrid");if(b.filterSource)for(var d=b.options,g=b.filterSource.rows,f=0;f<g.length;f++)if(g[f][d.idField]==
c){g.splice(f,1);b.filterSource.total--;break}});return z(b,c)}});var A={filterMenuIconCls:"icon-ok",filterBtnIconCls:"icon-filter",filterBtnPosition:"right",filterPosition:"bottom",remoteFilter:!1,showFilterBar:!0,filterDelay:400,filterRules:[],filterMatchingType:"all",filterIncludingChild:!1,filterMatcher:function(c){function d(b,c){k.val==a.fn.combogrid.defaults.val&&(k.val=A.val);var d=k.filterRules;if(!d.length)return!0;for(var g=0;g<d.length;g++){var f=d[g],e=n.datagrid("getColumnOption",f.field);
e=e&&e.formatter?e.formatter(b[f.field],b,c):void 0;e=k.val.call(n[0],b,f.field,e);void 0==e&&(e="");f=k.operators[f.op].isMatch(e,f.value);if("any"==k.filterMatchingType){if(f)return!0}else if(!f)return!1}return"all"==k.filterMatchingType}function g(a,b){for(var c=0;c<a.length;c++){var d=a[c];if(d[k.idField]==b)return d}return null}function f(b,c){c=e(b,c);for(var d=a.extend(!0,[],c);d.length;){var g=d.shift();g=e(b,g[k.idField]);c=c.concat(g);d=d.concat(g)}return c}function e(a,b){for(var c=[],
d=0;d<a.length;d++){var g=a[d];g._parentId==b&&c.push(g)}return c}var h=b(this),n=a(this),k=a.data(this,h).options;if(k.filterRules.length){var l=[];if("treegrid"==h){var m={};a.map(c.rows,function(b){if(d(b,b[k.idField])){m[b[k.idField]]=b;for(var e=g(c.rows,b._parentId);e;)m[e[k.idField]]=e,e=g(c.rows,e._parentId);k.filterIncludingChild&&(b=f(c.rows,b[k.idField]),a.map(b,function(a){m[a[k.idField]]=a}))}});for(var q in m)l.push(m[q])}else for(h=0;h<c.rows.length;h++)q=c.rows[h],d(q,h)&&l.push(q);
c={total:c.total-(c.rows.length-l.length),rows:l}}return c},defaultFilterType:"text",defaultFilterOperator:"contains",defaultFilterOptions:{onInit:function(c){function d(){var b=a(c)[g]("getFilterRule",e),d=h.val();if(""!=d){if(b&&b.value!=d||!b)a(c)[g]("addFilterRule",{field:e,op:f.defaultFilterOperator,value:d}),a(c)[g]("doFilter")}else b&&(a(c)[g]("removeFilterRule",e),a(c)[g]("doFilter"))}var g=b(c),f=a(c)[g]("options"),e=a(this).attr("name"),h=a(this);h.data("textbox")&&(h=h.textbox("textbox"));
h.unbind(".filter").bind("keydown.filter",function(b){a(this);this.timer&&clearTimeout(this.timer);13==b.keyCode?d():this.timer=setTimeout(function(){d()},f.filterDelay)})}},filterStringify:function(a){return JSON.stringify(a)},val:function(a,b,c){return c||a[b]},onClickMenu:function(a,b){}};a.extend(a.fn.datagrid.defaults,A);a.extend(a.fn.treegrid.defaults,A);a.fn.datagrid.defaults.filters=a.extend({},a.fn.datagrid.defaults.editors,{label:{init:function(b,c){return a("<span></span>").appendTo(b)},
getValue:function(b){return a(b).html()},setValue:function(b,c){a(b).html(c)},resize:function(b,c){a(b)._outerWidth(c)._outerHeight(22)}}});a.fn.treegrid.defaults.filters=a.fn.datagrid.defaults.filters;a.fn.datagrid.defaults.operators={nofilter:{text:"No Filter"},contains:{text:"Contains",isMatch:function(a,b){a=String(a);b=String(b);return 0<=a.toLowerCase().indexOf(b.toLowerCase())}},equal:{text:"Equal",isMatch:function(a,b){return a==b}},notequal:{text:"Not Equal",isMatch:function(a,b){return a!=
b}},beginwith:{text:"Begin With",isMatch:function(a,b){a=String(a);b=String(b);return 0==a.toLowerCase().indexOf(b.toLowerCase())}},endwith:{text:"End With",isMatch:function(a,b){a=String(a);b=String(b);return-1!==a.toLowerCase().indexOf(b.toLowerCase(),a.length-b.length)}},less:{text:"Less",isMatch:function(a,b){return a<b}},lessorequal:{text:"Less Or Equal",isMatch:function(a,b){return a<=b}},greater:{text:"Greater",isMatch:function(a,b){return a>b}},greaterorequal:{text:"Greater Or Equal",isMatch:function(a,
b){return a>=b}}};a.fn.treegrid.defaults.operators=a.fn.datagrid.defaults.operators;a.extend(a.fn.datagrid.methods,{enableFilter:function(c,d){return c.each(function(){var c=b(this),g=a.data(this,c).options;if(g.oldLoadFilter)if(d)a(this)[c]("disableFilter");else return;g.oldLoadFilter=g.loadFilter;f(this,d);a(this)[c]("resize");g.filterRules.length&&(g.remoteFilter?k(this):g.data&&k(this))})},disableFilter:function(c){return c.each(function(){var c=b(this),d=a.data(this,c),g=d.options;if(g.oldLoadFilter){var f=
a(this).data("datagrid").dc,e=f.view.children(".datagrid-filter-cache");e.length||(e=a('<div class="datagrid-filter-cache"></div>').appendTo(f.view));for(var h in g.filterCache)a(g.filterCache[h]).appendTo(e);e=d.data;d.filterSource&&(e=d.filterSource,a.map(e.rows,function(a){a.children=void 0}));f.header1.add(f.header2).find("tr.datagrid-filter-row").remove();g.loadFilter=g.oldLoadFilter||void 0;g.oldLoadFilter=null;a(this)[c]("resize");a(this)[c]("loadData",e)}})},destroyFilter:function(c,d){return c.each(function(){function c(b){var c=
a(f.filterCache[b]),d=c.find(".datagrid-filter");if(d.length){var g=d[0].filter;g.destroy&&g.destroy(d[0])}c.find(".datagrid-filter-btn").each(function(){a(this.menu).menu("destroy")});c.remove();f.filterCache[b]=void 0}var g=b(this),f=a.data(this,g).options;if(d)c(d);else{for(var e in f.filterCache)c(e);a(this).datagrid("getPanel").find(".datagrid-header .datagrid-filter-row").remove();a(this).data("datagrid").dc.view.children(".datagrid-filter-cache").remove();f.filterCache={};a(this)[g]("resize");
a(this)[g]("disableFilter")}})},getFilterRule:function(c,d){c=c[0];var g=b(c);g=a(c)[g]("options").filterRules;d=e(c,d);d=0<=d?g[d]:null;return d},addFilterRule:function(a,b){return a.each(function(){h(this,b)})},removeFilterRule:function(a,b){return a.each(function(){l(this,b)})},doFilter:function(a){return a.each(function(){k(this)})},getFilterComponent:function(a,b){return d(a[0],b)},resizeFilter:function(a,b){return a.each(function(){c(this,b)})}})})(jQuery);/*
 For open source use: GPLv3
          For commercial use: JSColor Commercial License
 @author  Jan Odvarko
 @version 2.0.5

 See usage examples at http://jscolor.com/examples/
*/
window.jscolor||(window.jscolor=function(){var a={register:function(){a.attachDOMReadyEvent(a.init);a.attachEvent(document,"mousedown",a.onDocumentMouseDown);a.attachEvent(document,"touchstart",a.onDocumentTouchStart);a.attachEvent(window,"resize",a.onWindowResize)},init:function(){a.jscolor.lookupClass&&a.jscolor.installByClassName(a.jscolor.lookupClass)},tryInstallOnElements:function(b,c){c=new RegExp("(^|\\s)("+c+")(\\s*(\\{[^}]*\\})|\\s|$)","i");for(var d=0;d<b.length;d+=1)if(void 0===b[d].type||
"color"!=b[d].type.toLowerCase()||!a.isColorAttrSupported){var e;if(!b[d].jscolor&&b[d].className&&(e=b[d].className.match(c))){var h=b[d],l=null,k=a.getDataAttr(h,"jscolor");null!==k?l=k:e[4]&&(l=e[4]);k={};if(l)try{k=(new Function("return ("+l+")"))()}catch(m){a.warn("Error parsing jscolor options: "+m+":\n"+l)}h.jscolor=new a.jscolor(h,k)}}},isColorAttrSupported:function(){var a=document.createElement("input");return a.setAttribute&&(a.setAttribute("type","color"),"color"==a.type.toLowerCase())?
!0:!1}(),isCanvasSupported:function(){var a=document.createElement("canvas");return!(!a.getContext||!a.getContext("2d"))}(),fetchElement:function(a){return"string"===typeof a?document.getElementById(a):a},isElementType:function(a,c){return a.nodeName.toLowerCase()===c.toLowerCase()},getDataAttr:function(a,c){a=a.getAttribute("data-"+c);return null!==a?a:null},attachEvent:function(a,c,d){a.addEventListener?a.addEventListener(c,d,!1):a.attachEvent&&a.attachEvent("on"+c,d)},detachEvent:function(a,c,
d){a.removeEventListener?a.removeEventListener(c,d,!1):a.detachEvent&&a.detachEvent("on"+c,d)},_attachedGroupEvents:{},attachGroupEvent:function(b,c,d,e){a._attachedGroupEvents.hasOwnProperty(b)||(a._attachedGroupEvents[b]=[]);a._attachedGroupEvents[b].push([c,d,e]);a.attachEvent(c,d,e)},detachGroupEvents:function(b){if(a._attachedGroupEvents.hasOwnProperty(b)){for(var c=0;c<a._attachedGroupEvents[b].length;c+=1){var d=a._attachedGroupEvents[b][c];a.detachEvent(d[0],d[1],d[2])}delete a._attachedGroupEvents[b]}},
attachDOMReadyEvent:function(a){var b=!1,d=function(){b||(b=!0,a())};if("complete"===document.readyState)setTimeout(d,1);else if(document.addEventListener)document.addEventListener("DOMContentLoaded",d,!1),window.addEventListener("load",d,!1);else if(document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",arguments.callee),d())}),window.attachEvent("onload",d),document.documentElement.doScroll&&window==
window.top)){var e=function(){if(document.body)try{document.documentElement.doScroll("left"),d()}catch(h){setTimeout(e,1)}};e()}},warn:function(a){window.console&&window.console.warn&&window.console.warn(a)},preventDefault:function(a){a.preventDefault&&a.preventDefault();a.returnValue=!1},captureTarget:function(b){b.setCapture&&(a._capturedTarget=b,a._capturedTarget.setCapture())},releaseTarget:function(){a._capturedTarget&&(a._capturedTarget.releaseCapture(),a._capturedTarget=null)},fireEvent:function(a,
c){if(a)if(document.createEvent){var b=document.createEvent("HTMLEvents");b.initEvent(c,!0,!0);a.dispatchEvent(b)}else if(document.createEventObject)b=document.createEventObject(),a.fireEvent("on"+c,b);else if(a["on"+c])a["on"+c]()},classNameToList:function(a){return a.replace(/^\s+|\s+$/g,"").split(/\s+/)},hasClass:function(a,c){return c?-1!=(" "+a.className.replace(/\s+/g," ")+" ").indexOf(" "+c+" "):!1},setClass:function(b,c){c=a.classNameToList(c);for(var d=0;d<c.length;d+=1)a.hasClass(b,c[d])||
(b.className+=(b.className?" ":"")+c[d])},unsetClass:function(b,c){c=a.classNameToList(c);for(var d=0;d<c.length;d+=1)b.className=b.className.replace(new RegExp("^\\s*"+c[d]+"\\s*|\\s*"+c[d]+"\\s*$|\\s+"+c[d]+"(\\s+)","g"),"$1")},getStyle:function(a){return window.getComputedStyle?window.getComputedStyle(a):a.currentStyle},setStyle:function(){var a=document.createElement("div"),c=function(b){for(var c=0;c<b.length;c+=1)if(b[c]in a.style)return b[c]},d={borderRadius:c(["borderRadius","MozBorderRadius",
"webkitBorderRadius"]),boxShadow:c(["boxShadow","MozBoxShadow","webkitBoxShadow"])};return function(a,b,c){switch(b.toLowerCase()){case "opacity":b=Math.round(100*parseFloat(c));a.style.opacity=c;a.style.filter="alpha(opacity="+b+")";break;default:a.style[d[b]]=c}}}(),setBorderRadius:function(b,c){a.setStyle(b,"borderRadius",c||"0")},setBoxShadow:function(b,c){a.setStyle(b,"boxShadow",c||"none")},getElementPos:function(b,c){var d=b.getBoundingClientRect();b=d.left;d=d.top;c||(c=a.getViewPos(),b+=
c[0],d+=c[1]);return[b,d]},getElementSize:function(a){return[a.offsetWidth,a.offsetHeight]},getAbsPointerPos:function(a){a||(a=window.event);var b=0,d=0;"undefined"!==typeof a.changedTouches&&a.changedTouches.length?(b=a.changedTouches[0].clientX,d=a.changedTouches[0].clientY):"number"===typeof a.clientX&&(b=a.clientX,d=a.clientY);return{x:b,y:d}},getRelPointerPos:function(a){a||(a=window.event);var b=(a.target||a.srcElement).getBoundingClientRect(),d=0,e=0;"undefined"!==typeof a.changedTouches&&
a.changedTouches.length?(d=a.changedTouches[0].clientX,e=a.changedTouches[0].clientY):"number"===typeof a.clientX&&(d=a.clientX,e=a.clientY);return{x:d-b.left,y:e-b.top}},getViewPos:function(){var a=document.documentElement;return[(window.pageXOffset||a.scrollLeft)-(a.clientLeft||0),(window.pageYOffset||a.scrollTop)-(a.clientTop||0)]},getViewSize:function(){var a=document.documentElement;return[window.innerWidth||a.clientWidth,window.innerHeight||a.clientHeight]},redrawPosition:function(){if(a.picker&&
a.picker.owner){var b=a.picker.owner;if(b.fixed){var c=a.getElementPos(b.targetElement,!0);var d=[0,0]}else c=a.getElementPos(b.targetElement),d=a.getViewPos();var e=a.getElementSize(b.targetElement),h=a.getViewSize(),l=a.getPickerOuterDims(b);switch(b.position.toLowerCase()){case "left":var k=1;var m=0;var p=-1;break;case "right":k=1;m=0;p=1;break;case "top":k=0;m=1;p=-1;break;default:k=0,p=m=1}var f=(e[m]+l[m])/2;d=b.smartPosition?[-d[k]+c[k]+l[k]>h[k]?-d[k]+c[k]+e[k]/2>h[k]/2&&0<=c[k]+e[k]-l[k]?
c[k]+e[k]-l[k]:c[k]:c[k],-d[m]+c[m]+e[m]+l[m]-f+f*p>h[m]?-d[m]+c[m]+e[m]/2>h[m]/2&&0<=c[m]+e[m]-f-f*p?c[m]+e[m]-f-f*p:c[m]+e[m]-f+f*p:0<=c[m]+e[m]-f+f*p?c[m]+e[m]-f+f*p:c[m]+e[m]-f-f*p]:[c[k],c[m]+e[m]-f+f*p];a._drawPosition(b,d[k],d[m],b.fixed?"fixed":"absolute",(d[0]+l[0]>c[0]||d[0]<c[0]+e[0])&&d[1]+l[1]<c[1]+e[1])}},_drawPosition:function(b,c,d,e,h){h=h?0:b.shadowBlur;a.picker.wrap.style.position=e;a.picker.wrap.style.left=c+"px";a.picker.wrap.style.top=d+"px";a.setBoxShadow(a.picker.boxS,b.shadow?
new a.BoxShadow(0,h,b.shadowBlur,0,b.shadowColor):null)},getPickerDims:function(b){var c=!!a.getSliderComponent(b);return[2*b.insetWidth+2*b.padding+b.width+(c?2*b.insetWidth+a.getPadToSliderPadding(b)+b.sliderSize:0),2*b.insetWidth+2*b.padding+b.height+(b.closable?2*b.insetWidth+b.padding+b.buttonHeight:0)]},getPickerOuterDims:function(b){var c=a.getPickerDims(b);return[c[0]+2*b.borderWidth,c[1]+2*b.borderWidth]},getPadToSliderPadding:function(a){return Math.max(a.padding,1.5*(2*a.pointerBorderWidth+
a.pointerThickness))},getPadYComponent:function(a){switch(a.mode.charAt(1).toLowerCase()){case "v":return"v"}return"s"},getSliderComponent:function(a){if(2<a.mode.length)switch(a.mode.charAt(2).toLowerCase()){case "s":return"s";case "v":return"v"}return null},onDocumentMouseDown:function(b){b||(b=window.event);var c=b.target||b.srcElement;if(c._jscLinkedInstance)c._jscLinkedInstance.showOnClick&&c._jscLinkedInstance.show();else if(c._jscControlName)a.onControlPointerStart(b,c,c._jscControlName,"mouse");
else a.picker&&a.picker.owner&&a.picker.owner.hide()},onDocumentTouchStart:function(b){b||(b=window.event);var c=b.target||b.srcElement;if(c._jscLinkedInstance)c._jscLinkedInstance.showOnClick&&c._jscLinkedInstance.show();else if(c._jscControlName)a.onControlPointerStart(b,c,c._jscControlName,"touch");else a.picker&&a.picker.owner&&a.picker.owner.hide()},onWindowResize:function(b){a.redrawPosition()},onParentScroll:function(b){a.picker&&a.picker.owner&&a.picker.owner.hide()},_pointerMoveEvent:{mouse:"mousemove",
touch:"touchmove"},_pointerEndEvent:{mouse:"mouseup",touch:"touchend"},_pointerOrigin:null,_capturedTarget:null,onControlPointerStart:function(b,c,d,e){var h=c._jscInstance;a.preventDefault(b);a.captureTarget(c);var l=function(h,k){a.attachGroupEvent("drag",h,a._pointerMoveEvent[e],a.onDocumentPointerMove(b,c,d,e,k));a.attachGroupEvent("drag",h,a._pointerEndEvent[e],a.onDocumentPointerEnd(b,c,d,e))};l(document,[0,0]);if(window.parent&&window.frameElement){var k=window.frameElement.getBoundingClientRect();
l(window.parent.window.document,[-k.left,-k.top])}l=a.getAbsPointerPos(b);k=a.getRelPointerPos(b);a._pointerOrigin={x:l.x-k.x,y:l.y-k.y};switch(d){case "pad":switch(a.getSliderComponent(h)){case "s":0===h.hsv[1]&&h.fromHSV(null,100,null);break;case "v":0===h.hsv[2]&&h.fromHSV(null,null,100)}a.setPad(h,b,0,0);break;case "sld":a.setSld(h,b,0)}a.dispatchFineChange(h)},onDocumentPointerMove:function(b,c,d,e,h){return function(b){var e=c._jscInstance;switch(d){case "pad":b||(b=window.event);a.setPad(e,
b,h[0],h[1]);a.dispatchFineChange(e);break;case "sld":b||(b=window.event),a.setSld(e,b,h[1]),a.dispatchFineChange(e)}}},onDocumentPointerEnd:function(b,c,d,e){return function(b){b=c._jscInstance;a.detachGroupEvents("drag");a.releaseTarget();a.dispatchChange(b)}},dispatchChange:function(b){b.valueElement&&a.isElementType(b.valueElement,"input")&&a.fireEvent(b.valueElement,"change")},dispatchFineChange:function(a){a.onFineChange&&("string"===typeof a.onFineChange?new Function(a.onFineChange):a.onFineChange).call(a)},
setPad:function(b,c,d,e){c=a.getAbsPointerPos(c);d=360/(b.width-1)*(d+c.x-a._pointerOrigin.x-b.padding-b.insetWidth);e=100-100/(b.height-1)*(e+c.y-a._pointerOrigin.y-b.padding-b.insetWidth);switch(a.getPadYComponent(b)){case "s":b.fromHSV(d,e,null,a.leaveSld);break;case "v":b.fromHSV(d,null,e,a.leaveSld)}},setSld:function(b,c,d){c=a.getAbsPointerPos(c);d=100-100/(b.height-1)*(d+c.y-a._pointerOrigin.y-b.padding-b.insetWidth);switch(a.getSliderComponent(b)){case "s":b.fromHSV(null,d,null,a.leavePad);
break;case "v":b.fromHSV(null,null,d,a.leavePad)}},_vmlNS:"jsc_vml_",_vmlCSS:"jsc_vml_css_",_vmlReady:!1,initVML:function(){if(!a._vmlReady){var b=document;b.namespaces[a._vmlNS]||b.namespaces.add(a._vmlNS,"urn:schemas-microsoft-com:vml");if(!b.styleSheets[a._vmlCSS]){var c="shape shapetype group background path formulas handles fill stroke shadow textbox textpath imagedata line polyline curve rect roundrect oval arc image".split(" ");b=b.createStyleSheet();b.owningElement.id=a._vmlCSS;for(var d=
0;d<c.length;d+=1)b.addRule(a._vmlNS+"\\:"+c[d],"behavior:url(#default#VML);")}a._vmlReady=!0}},createPalette:function(){var b={elm:null,draw:null};if(a.isCanvasSupported){var c=document.createElement("canvas"),d=c.getContext("2d"),e=function(a,b,e){c.width=a;c.height=b;d.clearRect(0,0,c.width,c.height);a=d.createLinearGradient(0,0,c.width,0);a.addColorStop(0,"#F00");a.addColorStop(1/6,"#FF0");a.addColorStop(2/6,"#0F0");a.addColorStop(.5,"#0FF");a.addColorStop(4/6,"#00F");a.addColorStop(5/6,"#F0F");
a.addColorStop(1,"#F00");d.fillStyle=a;d.fillRect(0,0,c.width,c.height);a=d.createLinearGradient(0,0,0,c.height);switch(e.toLowerCase()){case "s":a.addColorStop(0,"rgba(255,255,255,0)");a.addColorStop(1,"rgba(255,255,255,1)");break;case "v":a.addColorStop(0,"rgba(0,0,0,0)"),a.addColorStop(1,"rgba(0,0,0,1)")}d.fillStyle=a;d.fillRect(0,0,c.width,c.height)};b.elm=c}else{a.initVML();var h=document.createElement("div");h.style.position="relative";h.style.overflow="hidden";var l=document.createElement(a._vmlNS+
":fill");l.type="gradient";l.method="linear";l.angle="90";l.colors="16.67% #F0F, 33.33% #00F, 50% #0FF, 66.67% #0F0, 83.33% #FF0";var k=document.createElement(a._vmlNS+":rect");k.style.position="absolute";k.style.left="-1px";k.style.top="-1px";k.stroked=!1;k.appendChild(l);h.appendChild(k);var m=document.createElement(a._vmlNS+":fill");m.type="gradient";m.method="linear";m.angle="180";m.opacity="0";var p=document.createElement(a._vmlNS+":rect");p.style.position="absolute";p.style.left="-1px";p.style.top=
"-1px";p.stroked=!1;p.appendChild(m);h.appendChild(p);e=function(a,b,c){h.style.width=a+"px";h.style.height=b+"px";k.style.width=p.style.width=a+1+"px";k.style.height=p.style.height=b+1+"px";l.color="#F00";l.color2="#F00";switch(c.toLowerCase()){case "s":m.color=m.color2="#FFF";break;case "v":m.color=m.color2="#000"}};b.elm=h}b.draw=e;return b},createSliderGradient:function(){var b={elm:null,draw:null};if(a.isCanvasSupported){var c=document.createElement("canvas"),d=c.getContext("2d"),e=function(a,
b,f,e){c.width=a;c.height=b;d.clearRect(0,0,c.width,c.height);a=d.createLinearGradient(0,0,0,c.height);a.addColorStop(0,f);a.addColorStop(1,e);d.fillStyle=a;d.fillRect(0,0,c.width,c.height)};b.elm=c}else{a.initVML();var h=document.createElement("div");h.style.position="relative";h.style.overflow="hidden";var l=document.createElement(a._vmlNS+":fill");l.type="gradient";l.method="linear";l.angle="180";var k=document.createElement(a._vmlNS+":rect");k.style.position="absolute";k.style.left="-1px";k.style.top=
"-1px";k.stroked=!1;k.appendChild(l);h.appendChild(k);e=function(a,b,c,d){h.style.width=a+"px";h.style.height=b+"px";k.style.width=a+1+"px";k.style.height=b+1+"px";l.color=c;l.color2=d};b.elm=h}b.draw=e;return b},leaveValue:1,leaveStyle:2,leavePad:4,leaveSld:8,BoxShadow:function(){var a=function(a,b,e,h,l,k){this.hShadow=a;this.vShadow=b;this.blur=e;this.spread=h;this.color=l;this.inset=!!k};a.prototype.toString=function(){var a=[Math.round(this.hShadow)+"px",Math.round(this.vShadow)+"px",Math.round(this.blur)+
"px",Math.round(this.spread)+"px",this.color];this.inset&&a.push("inset");return a.join(" ")};return a}(),jscolor:function(b,c){function d(a,b,c){c=c/100*255;if(null===a)return[c,c,c];a/=60;b/=100;var d=Math.floor(a),g=c*(1-b);a=c*(1-b*(d%2?a-d:1-(a-d)));switch(d){case 6:case 0:return[c,a,g];case 1:return[a,c,g];case 2:return[g,c,a];case 3:return[g,a,c];case 4:return[a,g,c];case 5:return[c,g,a]}}function e(){f._processParentElementsInDOM();a.picker||(a.picker={owner:null,wrap:document.createElement("div"),
box:document.createElement("div"),boxS:document.createElement("div"),boxB:document.createElement("div"),pad:document.createElement("div"),padB:document.createElement("div"),padM:document.createElement("div"),padPal:a.createPalette(),cross:document.createElement("div"),crossBY:document.createElement("div"),crossBX:document.createElement("div"),crossLY:document.createElement("div"),crossLX:document.createElement("div"),sld:document.createElement("div"),sldB:document.createElement("div"),sldM:document.createElement("div"),
sldGrad:a.createSliderGradient(),sldPtrS:document.createElement("div"),sldPtrIB:document.createElement("div"),sldPtrMB:document.createElement("div"),sldPtrOB:document.createElement("div"),btn:document.createElement("div"),btnT:document.createElement("span")},a.picker.pad.appendChild(a.picker.padPal.elm),a.picker.padB.appendChild(a.picker.pad),a.picker.cross.appendChild(a.picker.crossBY),a.picker.cross.appendChild(a.picker.crossBX),a.picker.cross.appendChild(a.picker.crossLY),a.picker.cross.appendChild(a.picker.crossLX),
a.picker.padB.appendChild(a.picker.cross),a.picker.box.appendChild(a.picker.padB),a.picker.box.appendChild(a.picker.padM),a.picker.sld.appendChild(a.picker.sldGrad.elm),a.picker.sldB.appendChild(a.picker.sld),a.picker.sldB.appendChild(a.picker.sldPtrOB),a.picker.sldPtrOB.appendChild(a.picker.sldPtrMB),a.picker.sldPtrMB.appendChild(a.picker.sldPtrIB),a.picker.sldPtrIB.appendChild(a.picker.sldPtrS),a.picker.box.appendChild(a.picker.sldB),a.picker.box.appendChild(a.picker.sldM),a.picker.btn.appendChild(a.picker.btnT),
a.picker.box.appendChild(a.picker.btn),a.picker.boxB.appendChild(a.picker.box),a.picker.wrap.appendChild(a.picker.boxS),a.picker.wrap.appendChild(a.picker.boxB));var b=a.picker,c=!!a.getSliderComponent(f),d=a.getPickerDims(f),e=2*f.pointerBorderWidth+f.pointerThickness+2*f.crossSize,k=a.getPadToSliderPadding(f),m=Math.min(f.borderRadius,Math.round(f.padding*Math.PI));b.wrap.style.clear="both";b.wrap.style.width=d[0]+2*f.borderWidth+"px";b.wrap.style.height=d[1]+2*f.borderWidth+"px";b.wrap.style.zIndex=
f.zIndex;b.box.style.width=d[0]+"px";b.box.style.height=d[1]+"px";b.boxS.style.position="absolute";b.boxS.style.left="0";b.boxS.style.top="0";b.boxS.style.width="100%";b.boxS.style.height="100%";a.setBorderRadius(b.boxS,m+"px");b.boxB.style.position="relative";b.boxB.style.border=f.borderWidth+"px solid";b.boxB.style.borderColor=f.borderColor;b.boxB.style.background=f.backgroundColor;a.setBorderRadius(b.boxB,m+"px");b.padM.style.background=b.sldM.style.background="#FFF";a.setStyle(b.padM,"opacity",
"0");a.setStyle(b.sldM,"opacity","0");b.pad.style.position="relative";b.pad.style.width=f.width+"px";b.pad.style.height=f.height+"px";b.padPal.draw(f.width,f.height,a.getPadYComponent(f));b.padB.style.position="absolute";b.padB.style.left=f.padding+"px";b.padB.style.top=f.padding+"px";b.padB.style.border=f.insetWidth+"px solid";b.padB.style.borderColor=f.insetColor;b.padM._jscInstance=f;b.padM._jscControlName="pad";b.padM.style.position="absolute";b.padM.style.left="0";b.padM.style.top="0";b.padM.style.width=
f.padding+2*f.insetWidth+f.width+k/2+"px";b.padM.style.height=d[1]+"px";b.padM.style.cursor="crosshair";b.cross.style.position="absolute";b.cross.style.left=b.cross.style.top="0";b.cross.style.width=b.cross.style.height=e+"px";b.crossBY.style.position=b.crossBX.style.position="absolute";b.crossBY.style.background=b.crossBX.style.background=f.pointerBorderColor;b.crossBY.style.width=b.crossBX.style.height=2*f.pointerBorderWidth+f.pointerThickness+"px";b.crossBY.style.height=b.crossBX.style.width=e+
"px";b.crossBY.style.left=b.crossBX.style.top=Math.floor(e/2)-Math.floor(f.pointerThickness/2)-f.pointerBorderWidth+"px";b.crossBY.style.top=b.crossBX.style.left="0";b.crossLY.style.position=b.crossLX.style.position="absolute";b.crossLY.style.background=b.crossLX.style.background=f.pointerColor;b.crossLY.style.height=b.crossLX.style.width=e-2*f.pointerBorderWidth+"px";b.crossLY.style.width=b.crossLX.style.height=f.pointerThickness+"px";b.crossLY.style.left=b.crossLX.style.top=Math.floor(e/2)-Math.floor(f.pointerThickness/
2)+"px";b.crossLY.style.top=b.crossLX.style.left=f.pointerBorderWidth+"px";b.sld.style.overflow="hidden";b.sld.style.width=f.sliderSize+"px";b.sld.style.height=f.height+"px";b.sldGrad.draw(f.sliderSize,f.height,"#000","#000");b.sldB.style.display=c?"block":"none";b.sldB.style.position="absolute";b.sldB.style.right=f.padding+"px";b.sldB.style.top=f.padding+"px";b.sldB.style.border=f.insetWidth+"px solid";b.sldB.style.borderColor=f.insetColor;b.sldM._jscInstance=f;b.sldM._jscControlName="sld";b.sldM.style.display=
c?"block":"none";b.sldM.style.position="absolute";b.sldM.style.right="0";b.sldM.style.top="0";b.sldM.style.width=f.sliderSize+k/2+f.padding+2*f.insetWidth+"px";b.sldM.style.height=d[1]+"px";b.sldM.style.cursor="default";b.sldPtrIB.style.border=b.sldPtrOB.style.border=f.pointerBorderWidth+"px solid "+f.pointerBorderColor;b.sldPtrOB.style.position="absolute";b.sldPtrOB.style.left=-(2*f.pointerBorderWidth+f.pointerThickness)+"px";b.sldPtrOB.style.top="0";b.sldPtrMB.style.border=f.pointerThickness+"px solid "+
f.pointerColor;b.sldPtrS.style.width=f.sliderSize+"px";b.sldPtrS.style.height=w+"px";b.btn.style.display=f.closable?"block":"none";b.btn.style.position="absolute";b.btn.style.left=f.padding+"px";b.btn.style.bottom=f.padding+"px";b.btn.style.padding="0 15px";b.btn.style.height=f.buttonHeight+"px";b.btn.style.border=f.insetWidth+"px solid";(function(){var a=f.insetColor.split(/\s+/);b.btn.style.borderColor=2>a.length?a[0]:a[1]+" "+a[0]+" "+a[0]+" "+a[1]})();b.btn.style.color=f.buttonColor;b.btn.style.font=
"12px sans-serif";b.btn.style.textAlign="center";try{b.btn.style.cursor="pointer"}catch(n){b.btn.style.cursor="hand"}b.btn.onmousedown=function(){f.hide()};b.btnT.style.lineHeight=f.buttonHeight+"px";b.btnT.innerHTML="";b.btnT.appendChild(document.createTextNode(f.closeText));h();l();a.picker.owner&&a.picker.owner!==f&&a.unsetClass(a.picker.owner.targetElement,f.activeClass);a.picker.owner=f;a.isElementType(u,"body")?a.redrawPosition():a._drawPosition(f,0,0,"relative",!1);b.wrap.parentNode!=u&&u.appendChild(b.wrap);
a.setClass(f.targetElement,f.activeClass)}function h(){switch(a.getPadYComponent(f)){case "s":var b=1;break;case "v":b=2}b=Math.round((1-f.hsv[b]/100)*(f.height-1));var c=-Math.floor((2*f.pointerBorderWidth+f.pointerThickness+2*f.crossSize)/2);a.picker.cross.style.left=Math.round(f.hsv[0]/360*(f.width-1))+c+"px";a.picker.cross.style.top=b+c+"px";switch(a.getSliderComponent(f)){case "s":c=d(f.hsv[0],100,f.hsv[2]);b=d(f.hsv[0],0,f.hsv[2]);c="rgb("+Math.round(c[0])+","+Math.round(c[1])+","+Math.round(c[2])+
")";a.picker.sldGrad.draw(f.sliderSize,f.height,c,"rgb("+Math.round(b[0])+","+Math.round(b[1])+","+Math.round(b[2])+")");break;case "v":b=d(f.hsv[0],f.hsv[1],100),c="rgb("+Math.round(b[0])+","+Math.round(b[1])+","+Math.round(b[2])+")",a.picker.sldGrad.draw(f.sliderSize,f.height,c,"#000")}}function l(){var b=a.getSliderComponent(f);if(b){switch(b){case "s":var c=1;break;case "v":c=2}a.picker.sldPtrOB.style.top=Math.round((1-f.hsv[c]/100)*(f.height-1))-(2*f.pointerBorderWidth+f.pointerThickness)-Math.floor(w/
2)+"px"}}function k(){return a.picker&&a.picker.owner===f}function m(){f.importColor()}this.value=null;this.styleElement=this.valueElement=b;this.refine=this.required=!0;this.hash=!1;this.uppercase=!0;this.onFineChange=null;this.activeClass="jscolor-active";this.overwriteImportant=!1;this.minS=0;this.maxS=100;this.minV=0;this.maxV=100;this.hsv=[0,0,100];this.rgb=[255,255,255];this.width=181;this.height=101;this.showOnClick=!0;this.mode="HSV";this.position="bottom";this.smartPosition=!0;this.sliderSize=
16;this.crossSize=8;this.closable=!1;this.closeText="Close";this.buttonColor="#000000";this.buttonHeight=18;this.padding=12;this.backgroundColor="#FFFFFF";this.borderWidth=1;this.borderColor="#BBBBBB";this.borderRadius=8;this.insetWidth=1;this.insetColor="#BBBBBB";this.shadow=!0;this.shadowBlur=15;this.shadowColor="rgba(0,0,0,0.2)";this.pointerColor="#4C4C4C";this.pointerBorderColor="#FFFFFF";this.pointerBorderWidth=1;this.pointerThickness=2;this.zIndex=1E4;this.container=null;for(var p in c)c.hasOwnProperty(p)&&
(this[p]=c[p]);this.hide=function(){k()&&(a.unsetClass(f.targetElement,f.activeClass),a.picker.wrap.parentNode.removeChild(a.picker.wrap),delete a.picker.owner)};this.show=function(){e()};this.redraw=function(){k()&&e()};this.importColor=function(){this.valueElement?a.isElementType(this.valueElement,"input")?this.refine?!this.required&&/^\s*$/.test(this.valueElement.value)?(this.valueElement.value="",this.styleElement&&(this.styleElement.style.backgroundImage=this.styleElement._jscOrigStyle.backgroundImage,
this.styleElement.style.backgroundColor=this.styleElement._jscOrigStyle.backgroundColor,this.styleElement.style.color=this.styleElement._jscOrigStyle.color),this.exportColor(a.leaveValue|a.leaveStyle)):this.fromString(this.valueElement.value)||this.exportColor():this.fromString(this.valueElement.value,a.leaveValue)||(this.styleElement&&(this.styleElement.style.backgroundImage=this.styleElement._jscOrigStyle.backgroundImage,this.styleElement.style.backgroundColor=this.styleElement._jscOrigStyle.backgroundColor,
this.styleElement.style.color=this.styleElement._jscOrigStyle.color),this.exportColor(a.leaveValue|a.leaveStyle)):this.exportColor():this.exportColor()};this.exportColor=function(b){if(!(b&a.leaveValue)&&this.valueElement){var c=this.toString();this.uppercase&&(c=c.toUpperCase());this.hash&&(c="#"+c);a.isElementType(this.valueElement,"input")?this.valueElement.value=c:this.valueElement.innerHTML=c}if(!(b&a.leaveStyle)&&this.styleElement){c="#"+this.toString();var d=this.isLight()?"#000":"#FFF";this.styleElement.style.backgroundImage=
"none";this.styleElement.style.backgroundColor=c;this.styleElement.style.color=d;this.overwriteImportant&&this.styleElement.setAttribute("style","background: "+c+" !important; color: "+d+" !important;")}b&a.leavePad||!k()||h();b&a.leaveSld||!k()||l()};this.fromHSV=function(a,b,c,f){if(null!==a){if(isNaN(a))return!1;a=Math.max(0,Math.min(360,a))}if(null!==b){if(isNaN(b))return!1;b=Math.max(0,Math.min(100,this.maxS,b),this.minS)}if(null!==c){if(isNaN(c))return!1;c=Math.max(0,Math.min(100,this.maxV,
c),this.minV)}this.rgb=d(null===a?this.hsv[0]:this.hsv[0]=a,null===b?this.hsv[1]:this.hsv[1]=b,null===c?this.hsv[2]:this.hsv[2]=c);this.exportColor(f)};this.fromRGB=function(a,b,c,f){if(null!==a){if(isNaN(a))return!1;a=Math.max(0,Math.min(255,a))}if(null!==b){if(isNaN(b))return!1;b=Math.max(0,Math.min(255,b))}if(null!==c){if(isNaN(c))return!1;c=Math.max(0,Math.min(255,c))}a=null===a?this.rgb[0]:a;b=null===b?this.rgb[1]:b;var e=null===c?this.rgb[2]:c;a/=255;b/=255;e/=255;var g=Math.min(Math.min(a,
b),e);c=Math.max(Math.max(a,b),e);var h=c-g;0===h?a=[null,0,100*c]:(a=a===g?3+(e-b)/h:b===g?5+(a-e)/h:1+(b-a)/h,a=[60*(6===a?0:a),h/c*100,100*c]);null!==a[0]&&(this.hsv[0]=Math.max(0,Math.min(360,a[0])));0!==a[2]&&(this.hsv[1]=null===a[1]?null:Math.max(0,this.minS,Math.min(100,this.maxS,a[1])));this.hsv[2]=null===a[2]?null:Math.max(0,this.minV,Math.min(100,this.maxV,a[2]));a=d(this.hsv[0],this.hsv[1],this.hsv[2]);this.rgb[0]=a[0];this.rgb[1]=a[1];this.rgb[2]=a[2];this.exportColor(f)};this.fromString=
function(a,b){var c;if(c=a.match(/^\W*([0-9A-F]{3}([0-9A-F]{3})?)\W*$/i))return 6===c[1].length?this.fromRGB(parseInt(c[1].substr(0,2),16),parseInt(c[1].substr(2,2),16),parseInt(c[1].substr(4,2),16),b):this.fromRGB(parseInt(c[1].charAt(0)+c[1].charAt(0),16),parseInt(c[1].charAt(1)+c[1].charAt(1),16),parseInt(c[1].charAt(2)+c[1].charAt(2),16),b),!0;if(c=a.match(/^\W*rgba?\(([^)]*)\)\W*$/i)){a=c[1].split(",");c=/^\s*(\d*)(\.\d+)?\s*$/;var d,f,e;if(3<=a.length&&(d=a[0].match(c))&&(f=a[1].match(c))&&
(e=a[2].match(c)))return d=parseFloat((d[1]||"0")+(d[2]||"")),f=parseFloat((f[1]||"0")+(f[2]||"")),e=parseFloat((e[1]||"0")+(e[2]||"")),this.fromRGB(d,f,e,b),!0}return!1};this.toString=function(){return(256|Math.round(this.rgb[0])).toString(16).substr(1)+(256|Math.round(this.rgb[1])).toString(16).substr(1)+(256|Math.round(this.rgb[2])).toString(16).substr(1)};this.toHEXString=function(){return"#"+this.toString().toUpperCase()};this.toRGBString=function(){return"rgb("+Math.round(this.rgb[0])+","+Math.round(this.rgb[1])+
","+Math.round(this.rgb[2])+")"};this.isLight=function(){return 127.5<.213*this.rgb[0]+.715*this.rgb[1]+.072*this.rgb[2]};this._processParentElementsInDOM=function(){if(!this._linkedElementsProcessed){this._linkedElementsProcessed=!0;var b=this.targetElement;do{var c=a.getStyle(b);c&&"fixed"===c.position.toLowerCase()&&(this.fixed=!0);b===this.targetElement||b._jscEventsAttached||(a.attachEvent(b,"scroll",a.onParentScroll),b._jscEventsAttached=!0)}while((b=b.parentNode)&&!a.isElementType(b,"body"))}};
"string"===typeof b?(c=document.getElementById(b))?this.targetElement=c:a.warn("Could not find target element with ID '"+b+"'"):b?this.targetElement=b:a.warn("Invalid target element: '"+b+"'");if(this.targetElement._jscLinkedInstance)a.warn("Cannot link jscolor twice to the same element. Skipping.");else{this.targetElement._jscLinkedInstance=this;this.valueElement=a.fetchElement(this.valueElement);this.styleElement=a.fetchElement(this.styleElement);var f=this,u=this.container?a.fetchElement(this.container):
document.getElementsByTagName("body")[0],w=3;if(a.isElementType(this.targetElement,"button"))if(this.targetElement.onclick){var x=this.targetElement.onclick;this.targetElement.onclick=function(a){x.call(this,a);return!1}}else this.targetElement.onclick=function(){return!1};this.valueElement&&a.isElementType(this.valueElement,"input")&&(b=function(){f.fromString(f.valueElement.value,a.leaveValue);a.dispatchFineChange(f)},a.attachEvent(this.valueElement,"keyup",b),a.attachEvent(this.valueElement,"input",
b),a.attachEvent(this.valueElement,"blur",m),this.valueElement.setAttribute("autocomplete","off"));this.styleElement&&(this.styleElement._jscOrigStyle={backgroundImage:this.styleElement.style.backgroundImage,backgroundColor:this.styleElement.style.backgroundColor,color:this.styleElement.style.color});this.value?this.fromString(this.value)||this.exportColor():this.importColor()}}};a.jscolor.lookupClass="jscolor";a.jscolor.installByClassName=function(b){var c=document.getElementsByTagName("input"),
d=document.getElementsByTagName("button");a.tryInstallOnElements(c,b);a.tryInstallOnElements(d,b)};a.register();return a.jscolor}());var rootObj={absid:"",id:function(a){return"#"+this.absid.replace(/\./g,"_").replace(/\[/g,"_").replace(/\]/g,"_")+"_"+a},idh:function(a){var b=this.absid.replace(/\./g,"_").replace(/\[/g,"_").replace(/\]/g,"_");a&&(b=b+"_"+a);return b},prop:function(a){return this.absid+"."+a},localid:function(){var a=this.absid.split(".");return a[a.length-1]}},tc_class={__proto__:rootObj,record:{},fields:[],flagSet:!1,okclick:function(){this.save(this)},cancelclick:function(){this.winedit.window("close")},save:function(a){a.flagEdit?
a.saveDB(a,a.record,a.aftersave):this.winedit.window("close")},createSQLSave:function(a,b){var c=[],d=[];if(null!=a.finder.t_rpdeclare.savefieldlist&&""!=a.finder.t_rpdeclare.savefieldlist)c=a.finder.t_rpdeclare.savefieldlist.split(",");else for(var e in b)c.push(e);for(e=0;e<c.length;e++){null!=a.finder.DefaultValues[c[e]]&&(b[c[e]]=a.finder.DefaultValues[c[e]]);var h="null";if(b[c[e]]||0===b[c[e]])h="'"+b[c[e]].toString().replace(/'/g,"''")+"'";h=app.isP?"_"+c[e]+" => "+h:"@"+c[e]+" = "+h;d.push(h)}return app.isP?
"select * from "+a.finder.t_rpdeclare.editproc+"("+d.join(",")+")":"exec "+a.finder.t_rpdeclare.editproc+" "+d.join(",")},saveDBrecs:function(a,b,c){for(var d="",e=0;e<b.length;e++)d=d+a.createSQLSave(a,b[e])+";";$.post("/pg/runsql",{sql:d},function(b){b.message?$.messager.alert("\u041e\u0448\u0438\u0431\u043a\u0430.",b.message,"error"):c(a)})},saveDB:function(a,b,c){var d=a.createSQLSave(a,b);$.post("/pg/runsql",{sql:d},function(d){if(d.message)$.messager.alert("\u041e\u0448\u0438\u0431\u043a\u0430.",
d.message,"error");else{if(0<d.rows.length){d=d.rows[0];for(var e in d)b[e]=d[e]}c(a,b)}})},aftersave:function(a,b){var c={};if(1==a.action){c=a.finder.MainTab.datagrid("getSelected");var d=a.finder.MainTab.datagrid("getRowIndex",c),e;for(e in b)c[e]=b[e];a.finder.MainTab.datagrid("refreshRow",d)}else{for(e in b)c[e]=b[e];a.finder.MainTab.datagrid("appendRow",c);b=a.finder.MainTab.datagrid("getRows").length-1;a.finder.MainTab.datagrid("selectRow",b)}a.flagEdit=!1;a.winedit.window("close")},okcombo:function(a,
b,c){if(!a.flagSet){a.flagSet=!0;for(var d in a.fields[b].joinRow.fields)a.record[d]=c[a.fields[b].joinRow.fields[d]];a.setField(a);a.flagEdit=!0;a.flagSet=!1}},oklooksender:function(a,b){var c=a.fields[b].finder.MainTab.datagrid("getSelected");if(c){for(var d in a.fields[b].joinRow.fields)a.record[d]=c[a.fields[b].joinRow.fields[d]];a.setField(a);a.flagEdit=!0;a.fields[b].finder.win.window("close")}else $.messager.alert(a.fields[b].finder.t_rpdeclare.descr,"\u0412\u044b\u0431\u0435\u0440\u0435\u0442\u0435 \u0437\u0430\u043f\u0438\u0441\u044c",
"info")},cancelookup:function(a){this.fields[a].win.window("close")},onStart:function(a){},htmlContent:function(a,b){$(a.id("winedit")).remove();for(var c=0;c<a.fields.length;c++)$(a.id(a.fields[c].field)).remove();a.winedit=$('<div id="'+a.idh("winedit")+'" style="width:900px;height:500px;padding:10px 10px 0px 10px"></div>').appendTo("body");c=$("#okcancel").html();c=c.replace("OKFun",a.prop("okclick"));c=c.replace("CloseFun",a.prop("cancelclick"));return c=c.replace("Content",b)},save2json:function(a){res=
[];for(var b=0;b<a.fields.length;b++){var c={};c.field=a.fields[b].field;c.title=a.fields[b].title;c.DisplayFormat=a.fields[b].DisplayFormat;c.group=a.fields[b].group;c.tp=a.fields[b].tp;c.precision=a.fields[b].precision;c.joinRow=a.fields[b].joinRow;res.push(c)}return res},start:function(a){if(0==a.fields.length){a.fields=a.finder.frozenColumns.concat(a.finder.columns);for(var b=0;b<a.fields.length;b++){var c=a.fields[b].DisplayFormat,d="text",e=0;"color"==a.fields[b].field.toLowerCase()&&(d="color");
c&&(-1<c.indexOf("dd.")?(d="date",-1<c.indexOf("HH:mm")&&(d="datetime")):-1<c.indexOf("#")&&(d="numeric",(c=c.match(/0\.(0+)/))&&1<c.length&&(e=c[1].length)));a.fields[b].tp=d;a.fields[b].precision=e;if("text"==d){var h=app.t_sysfieldmap.filter(function(c){return c.decname==a.finder.t_rpdeclare.decname&&(c.dstfield.toLowerCase()==a.fields[b].field&&app.isP||c.dstfield==a.fields[b].field&&!app.isP)&&null!=c.classname});if(1==h.length){a.fields[b].joinRow={};a.fields[b].joinRow.IdDeclare=h[0].iddeclare;
a.fields[b].joinRow.classname=h[0].classname;a.fields[b].joinRow.fields={};d=app.t_sysfieldmap.filter(function(b){return b.decname==a.finder.t_rpdeclare.decname&&b.groupdec==h[0].groupdec});for(e=0;e<d.length;e++)app.isP?a.fields[b].joinRow.fields[d[e].dstfield.toLowerCase()]=d[e].srcfield.toLowerCase():a.fields[b].joinRow.fields[d[e].dstfield]=d[e].srcfield;"Bureau.GridCombo"==a.fields[b].joinRow.classname&&(a.fields[b].tp="combo",a.fields[b].joinRow.textField=app.isP?h[0].srcfield.toLowerCase():
h[0].srcfield)}}}}$(a.id("proptab")).remove();d=0;e="";c=a.idh("group");var l='<table class="datagrid-btable" cellspacing="0" cellpadding="0" style="width:100%" id="'+a.idh("proptab")+'"><tbody>',k='<tr class="treegrid-tr-tree"><td colspan="2" style="border:0px"><div style="display:block;" id="div'+c+d.toString()+'"><table class="datagrid-btable" cellspacing="1" cellpadding="0" style="width:100%;background-color:lightgray"><tbody>';a.finder.t_rpdeclare.savefieldlist||(a.finder.t_rpdeclare.savefieldlist=
"");savefieldlist=a.finder.t_rpdeclare.savefieldlist.split(",");for(b=0;b<a.fields.length;b++){var m='<tr class="datagrid-row">';m=m+'<td style="width:50%;background-color: white"><div style="height:auto;" class="datagrid-cell">'+a.fields[b].title+"</div></td>";m+='<td style="width:50%;background-color: white"><div style="height:auto;" class="datagrid-cell">';m="color"==a.fields[b].field?m+'<input  style="width:100%" class="jscolor"  id="'+a.idh(a.fields[b].field)+'"/>':m+'<input  style="width:100%" id="'+
a.idh(a.fields[b].field)+'"/>';m+="</div></td></tr>";var p=a.fields[b].group;p&&""!=p||(p=e);p!=e&&(e=p,0<b?(k+="</tbody></table></div></td></tr>",l+=k,d+=1,k='<tr class="datagrid-row datagrid-row-over"><td colspan="2" class="datagrid-cell" ><div class="tree-hit prop-expanded" onclick="app.expand(this.id)" id="'+c+d.toString()+'"></div><b> '+e+'</b></td></tr><tr class="treegrid-tr-tree"><td colspan="2" style="border:0px"><div style="display:block;" id="div'+c+d.toString()+'"><table class="datagrid-btable" cellspacing="1" cellpadding="0" style="width:100%;background-color:lightgray"><tbody>'):
k='<tr class="datagrid-row datagrid-row-over"><td colspan="2" class="datagrid-cell"><div class="tree-hit prop-expanded" onclick="app.expand(this.id)" id="'+c+d.toString()+'"></div><b> '+e+"</b></td></tr>"+k);k+=m}d=a.htmlContent(a,l+(k+"</tbody></table></div></td></tr></tbody></table>"));a.winedit.window({title:a.finder.t_rpdeclare.descr,modal:!0,collapsible:!1,minimizable:!1,closed:!0,content:d,onBeforeClose:function(){return a.flagEdit?($.messager.confirm({title:a.finder.t_rpdeclare.descr,msg:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0432 \u0437\u0430\u043f\u0438\u0441\u0438?",
fn:function(b){b?a.save(a):(a.flagEdit=!1,a.winedit.window("close"))},ok:"\u0414\u0430",cancel:"\u041d\u0435\u0442"}),!1):!0}});d={};for(b=0;b<a.fields.length;d={$jscomp$loop$prop$fname$10:d.$jscomp$loop$prop$fname$10,$jscomp$loop$prop$cnum$7:d.$jscomp$loop$prop$cnum$7,$jscomp$loop$prop$fnn$8:d.$jscomp$loop$prop$fnn$8,$jscomp$loop$prop$fnum$11:d.$jscomp$loop$prop$fnum$11},b++)if(d.$jscomp$loop$prop$fname$10=a.fields[b].field,e=a.fields[b].tp,"date"==e)$(a.id(d.$jscomp$loop$prop$fname$10)).datebox({onChange:function(b){return function(c,
d){c=app.dateparser(c);a.record[b.$jscomp$loop$prop$fname$10]=c;a.flagEdit=!0}}(d)});else if("datetime"==e)$(a.id(d.$jscomp$loop$prop$fname$10)).datetimebox({showSeconds:!1,onChange:function(b){return function(c,d){c=app.datetimeparser(c);a.record[b.$jscomp$loop$prop$fname$10]=c;a.flagEdit=!0}}(d)});else if("numeric"==e)$(a.id(d.$jscomp$loop$prop$fname$10)).numberbox({precision:a.fields[b].precision,decimalSeparator:",",onChange:function(b){return function(c,d){a.record[b.$jscomp$loop$prop$fname$10]=
c;a.flagEdit=!0}}(d)});else if("combo"==e)d.$jscomp$loop$prop$cnum$7=b,e=a.fields[d.$jscomp$loop$prop$cnum$7].joinRow.textField,$(a.id(d.$jscomp$loop$prop$fname$10)).combobox({url:"/pg/runsql",method:"POST",queryParams:{IdDeclare:a.fields[b].joinRow.IdDeclare,array:1},valueField:e,textField:e,onSelect:function(b){return function(c){a.okcombo(a,b.$jscomp$loop$prop$cnum$7,c)}}(d)});else if("color"==e)e=document.getElementById(a.idh(d.$jscomp$loop$prop$fname$10)),d.$jscomp$loop$prop$fnn$8=d.$jscomp$loop$prop$fname$10,
a.Color=new jscolor(e,{closable:!0,closeText:"Ok",required:!1,onFineChange:function(b){return function(){""==$(a.id(b.$jscomp$loop$prop$fnn$8)).val()?a.record.Color="":a.record.Color=-16777216|Math.round(a.Color.rgb[0])<<16|Math.round(a.Color.rgb[1])<<8|Math.round(a.Color.rgb[2]);a.flagEdit=!0}}(d)});else if("multi"==e)$(a.id(d.$jscomp$loop$prop$fname$10)).textbox({multiline:!0,height:100,disabled:-1==savefieldlist.indexOf(d.$jscomp$loop$prop$fname$10)&&!a.fields[b].joinRow,onChange:function(b){return function(c,
d){a.record[b.$jscomp$loop$prop$fname$10]=c;a.flagEdit=!0}}(d)});else if($(a.id(d.$jscomp$loop$prop$fname$10)).textbox({disabled:-1==savefieldlist.indexOf(d.$jscomp$loop$prop$fname$10)&&!a.fields[b].joinRow,onChange:function(b){return function(c,d){a.record[b.$jscomp$loop$prop$fname$10]=c;a.flagEdit=!0}}(d)}),a.fields[b].joinRow||"image_bmp"==a.fields[b].field)d.$jscomp$loop$prop$fnum$11=b,a.fields[b].joinRow||(a.fields[b].joinRow={}),a.fields[b].finder=a.fields[b].joinRow.finder_class?Object.create(a.fields[b].joinRow.finder_class):
"image_bmp"==a.fields[b].field?Object.create(image_editor):Object.create(finder),a.fields[b].finder.absid=a.prop("fields["+b.toString()+"].finder"),a.fields[b].finder.IdDeclare=a.fields[b].joinRow.IdDeclare,a.fields[b].finder.editform=a,a.fields[b].finder.fnum=d.$jscomp$loop$prop$fnum$11,a.fields[b].finder.OKFun=function(a){a.editform.oklooksender(a.editform,a.fnum)},a.fields[b].finder.start(),$(a.id(d.$jscomp$loop$prop$fname$10)).textbox({icons:[{iconCls:"icon-combo",handler:function(b){return function(c){a.showFinder(a,
b.$jscomp$loop$prop$fnum$11)}}(d)}]});a.onStart(a)},showFinder:function(a,b){a.fields[b].finder.show(a.fields[b].finder);a.onShowFinder(a,b)},onShowFinder:function(a,b){},onEdit:function(a){},editrecord:function(a){var b=a.finder.MainTab.datagrid("getSelected");if(b){a.record={};for(var c in b)a.record[c]=b[c];a.action=1;a.flagEdit=!1;a.setField(a);a.onEdit(a);a.winedit.window("open")}else $.messager.alert(a.finder.t_rpdeclare.descr,"\u0412\u044b\u0431\u0435\u0440\u0435\u0442\u0435 \u0437\u0430\u043f\u0438\u0441\u044c",
"info")},setField:function(a){for(var b=0;b<a.fields.length;b++){var c=a.fields[b].tp,d=a.record[a.fields[b].field],e=a.id(a.fields[b].field);a.idh(a.fields[b].field);"date"==c?(c=app.dateformat(d,"dd.MM.yyyy"),$(e).datebox("setValue",c)):"datetime"==c?(c=app.dateformat(d,"dd.MM.yyyy HH:mm"),$(e).datetimebox("setValue",c)):"numeric"==c?$(e).numberbox("setValue",d):"combo"==c?$(e).combobox("setValue",d):"color"==c?d?(e=app.colorParse(d),e=e.toUpperCase().substr(1),a.Color.fromString(e)):(a.Color.fromString("FFFFFF"),
$(e).val("")):$(e).textbox("setValue",d)}a.flagEdit=!1},addrecord:function(a){var b=a.finder.t_rpdeclare.editproc.toLowerCase(),c="";c=app.isP?a.finder.t_rpdeclare.keyfield.toLowerCase():a.finder.t_rpdeclare.keyfield;b=b.replace("p_","").replace("_edit","");$.get("/pg/getid/"+b,function(b){a.record={};a.record[c]=b.id;a.setField(a);a.action=0;a.flagEdit=!1;a.onEdit(a);a.winedit.window("open")})},deleterecord:function(a){var b=a.finder.MainTab.datagrid("getSelected");if(b){var c=a.finder.MainTab.datagrid("getRowIndex",
b);$.messager.confirm({title:a.finder.t_rpdeclare.descr,msg:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u044c?",fn:function(d){if(d){d="";d=app.isP?"'"+b[a.finder.t_rpdeclare.keyfield.toLowerCase()].toString().replace(/'/g,"''")+"'":"'"+b[a.finder.t_rpdeclare.keyfield].toString().replace(/'/g,"''")+"'";var e="select * from "+a.finder.t_rpdeclare.delproc+"("+d+")";app.isP||(e="exec "+a.finder.t_rpdeclare.delproc+" "+d,-1<a.finder.t_rpdeclare.delproc.toLowerCase().indexOf("_del_1")&&
(e=e+", '"+app.account+"', '"+app.account+"'"));$.post("/pg/runsql",{sql:e},function(b){b.message?$.messager.alert("\u041e\u0448\u0438\u0431\u043a\u0430.",b.message,"error"):a.finder.MainTab.datagrid("deleteRow",c)})}},ok:"\u0414\u0430",cancel:"\u041d\u0435\u0442"})}else $.messager.alert(a.finder.t_rpdeclare.descr,"\u0412\u044b\u0431\u0435\u0440\u0435\u0442\u0435 \u0437\u0430\u043f\u0438\u0441\u044c","info")}},column_editor={__proto__:rootObj,rows:[],show:function(a){$.post("/pg/runsql",{sql:"select paramvalue from t_sysParams  where  paramname = 'GridFind"+
a.editform.record.DecName+"'"},function(b){var c="";0<b.rows.length&&(c=b.rows[0].paramvalue);a.initdata(a,c)})},initdata:function(a,b){$("#teXML").textbox("setValue",b);a.rows=[];if(b&&""!=b)try{var c=$.parseXML(b);$("#FROZENCOLS").textbox("setValue",$(c).find("GRID").attr("FROZENCOLS"));$("#SumFields").textbox("setValue",$(c).find("GRID").attr("SumFields"));$("#LabelField").textbox("setValue",$(c).find("GRID").attr("LabelField"));$("#LabelText").textbox("setValue",$(c).find("GRID").attr("LabelText"));
var d=0;$(c).find("COLUMN").each(function(){a.rows.push({Visible:$(this).attr("Visible"),NN:d,FieldName:$(this).attr("FieldName"),FieldCaption:$(this).attr("FieldCaption"),Width:$(this).attr("Width"),DisplayFormat:$(this).attr("DisplayFormat"),group:$(this).attr("group")});d+=1})}catch(e){}else $("#FROZENCOLS").textbox("setValue","0"),$("#SumFields").textbox("setValue",""),$("#LabelField").textbox("setValue",""),$("#LabelText").textbox("setValue","\u0418\u0442\u043e\u0433\u043e:");$.post("/pg/runsql",
{sql:a.editform.record.DecSQL},function(b){var c=[];b.fields&&(c=b.fields);a.addinitdata(a,c)})},addinitdata:function(a,b){for(var c=a.rows.length,d={},e=0;e<b.length;d={$jscomp$loop$prop$fname$13:d.$jscomp$loop$prop$fname$13},e++)d.$jscomp$loop$prop$fname$13=b[e].name,0==a.rows.filter(function(a){return function(b){return b.FieldName==a.$jscomp$loop$prop$fname$13}}(d)).length&&(a.rows.push({Visible:"0",NN:c,FieldName:d.$jscomp$loop$prop$fname$13,FieldCaption:d.$jscomp$loop$prop$fname$13,Width:"100",
DisplayFormat:"",group:""}),c+=1);a.win.window("open");$("#customtab").editIndex=void 0;$("#customtab").datagrid({data:a.rows})},Save:function(a){for(var b=a.rows.sort(function(a,b){return a.NN-b.NN}),c='<GRID FROZENCOLS="'+$("#FROZENCOLS").val()+'" SumFields = "'+$("#SumFields").val()+'" LabelField = "'+$("#LabelField").val()+'" LabelText = "'+$("#LabelText").val()+'">',d=0;d<b.length;d++){var e="";b[d].group&&(e=b[d].group);c=c+'<COLUMN FieldName="'+b[d].FieldName+'" FieldCaption = "'+b[d].FieldCaption+
'" DisplayFormat = "'+b[d].DisplayFormat+'" Width = "'+b[d].Width+'" Visible = "'+b[d].Visible+'" group = "'+e;c+='" Sum = "0"  ColSort="1" />'}c+='<SAFEDEF SAFEDEF="1"/></GRID>';$("#teXML").textbox("setValue",c);a.SaveXML(a)},SaveXML:function(a){var b="GridFind"+a.editform.record.DecName,c=$("#teXML").val();$.post("/pg/runsql",{sql:"exec p_lbrsetparam '"+b+"', '"+c+"', '"+b+"'"},function(b){a.win.window("close")})},start:function(){$(this.id("win")).remove();var a=$("#frmcustom").html();this.win=
$('<div id="'+this.idh("win")+'" style="width:700px;height:500px;"></div>').appendTo("body");this.win.window({title:"\u041a\u043e\u043b\u043e\u043d\u043a\u0438",modal:!0,collapsible:!1,minimizable:!1,closed:!0,content:a});var b=this;$("#customtab").datagrid({idField:"FieldName",checkOnSelect:!1,selectOnCheck:!1,columns:[[{field:"Visible",title:"",width:20,editor:{type:"checkbox",options:{on:"1",off:"0"}},styler:function(a,b,e){return"background-color:#ffffff;"}},{field:"NN",title:"NN",width:30,editor:"numberbox",
sortable:!0},{field:"FieldName",title:"\u041f\u043e\u043b\u0435",width:100},{field:"FieldCaption",title:"\u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a",width:100,editor:"textbox"},{field:"Width",title:"\u0428\u0438\u0440\u0438\u043d\u0430",width:100,editor:"numberbox"},{field:"DisplayFormat",title:"\u0424\u043e\u0440\u043c\u0430\u0442",width:100,editor:"textbox"},{field:"group",title:"\u0413\u0440\u0443\u043f\u043f\u0430",width:100,editor:"textbox"}]],fitColumns:!0,fit:!0,singleSelect:!0,
sortName:"NN",sortOrder:"asc",remoteSort:!1,toolbar:[{iconCls:"icon-save",text:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",handler:function(){b.Save(b)}},"-",{iconCls:"tree-file",text:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c XML",handler:function(){b.SaveXML(b)}}],onClickCell:function(a,b){this.editIndex!=a&&(b=!0,void 0==this.editIndex?b=!0:$(this).datagrid("validateRow",this.editIndex)?($(this).datagrid("endEdit",this.editIndex),this.editIndex=void 0,b=!0):b=!1,b?($(this).datagrid("selectRow",
a).datagrid("beginEdit",a),this.editIndex=a):setTimeout(function(){$(this).datagrid("selectRow",editIndex)},0))}})}},image_editor={__proto__:rootObj,show:function(a){a.file.click()},start:function(){$(this.id("fileElem")).remove();this.file=$('<input type="file" id="'+this.idh("fileElem")+'" accept="image/*" style="display:none" onchange="'+this.prop("handleFiles(this.files)")+'">').appendTo("body")},handleFiles:function(a){if(a.length){var b=new FileReader,c=this.editform.id("image_bmp");b.onloadend=
function(){var a=b.result.split(",")[1];$(c).textbox("setValue",a)};b.readAsDataURL(a[0])}}},declare_editor={__proto__:tc_class,onShowFinder:function(a,b){},onStart:function(a){$(a.id("winedit")).window("open");var b=a.idh("group1");app.expand(b);$(a.id("winedit")).window("close")},fields:[{title:"\u041a\u043e\u0434",field:"IdDeclare",tp:"numeric"},{title:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",field:"DecName"},{title:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",field:"Descr"},{title:"\u0422\u0438\u043f",
field:"DecType",tp:"numeric"},{title:"\u041a\u043b\u044e\u0447\u0435\u0432\u043e\u0435 \u043f\u043e\u043b\u0435",field:"KeyField"},{title:"\u041e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u0435\u043c\u043e\u0435 \u043f\u043e\u043b\u0435",field:"DispField"},{title:"\u0414\u0435\u0442\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f",field:"KeyValue",joinRow:{IdDeclare:"75",classname:"Bureau.Finder",fields:{KeyValue:"IdDeclare"}}},{title:"\u0422\u0430\u0431\u043b\u0438\u0446\u0430",field:"TableName"},
{title:"\u0417\u0430\u043f\u0440\u043e\u0441",field:"DecSQL",tp:"multi"},{title:"\u041a\u0430\u0440\u0442\u0438\u043d\u043a\u0430",field:"image_bmp"},{title:"\u041a\u043e\u043b\u043e\u043d\u043a\u0438",field:"col_grid",joinRow:{finder_class:column_editor}},{title:"\u0424\u0443\u043d\u043a\u0446\u0438\u044f \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f",field:"EditProc"},{title:"\u0424\u0443\u043d\u043a\u0446\u0438\u044f \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f",field:"DelProc"},
{title:"\u0421\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u0435\u0439",field:"SaveFieldList"}]};$.fn.datebox.defaults.formatter=function(a){var b=a.getFullYear(),c=a.getMonth()+1;a=a.getDate();return(10>a?"0"+a:a)+"."+(10>c?"0"+c:c)+"."+b};$.fn.datebox.defaults.parser=function(a){if(a){var b=a.split(".");a=new Number(b[0]);var c=new Number(b[1]);b=new Number(b[2].substring(0,4));return new Date(b,c-1,a)}return new Date};
var app={isP:!1,account:"",password:"",startid:"",colorParse:function(a){a=Number(a);return"#"+(16777216+(a&255)+256*((a&65280)>>8)+65536*((a&16711680)>>16)).toString(16).substr(1)},dateparser:function(a){return a?(a=a.split("."),a[2].substr(0,4)+"-"+a[1]+"-"+a[0]+"T00:00:00.000Z"):null},datetimeparser:function(a){return a?(a=a.split("."),a[2].substr(0,4)+"-"+a[1]+"-"+a[0]+"T"+a[2].substr(5,2)+":"+a[2].substr(8,2)+":00.000Z"):null},dateformat:function(a,b){if(!a)return a;if(24!=a.length){b=b.match(/0\.(0+)/);
var c=0;b&&1<b.length&&(c=b[1].length);return 0<c?Number(a.toString()).toFixed(c):a}b=b.replace("yyyy",a.substr(0,4));b=b.replace("yy",a.substr(2,2));b=b.replace("MM",a.substr(5,2));b=b.replace("dd",a.substr(8,2));b=b.replace("HH",a.substr(11,2));return b=b.replace("mm",a.substr(14,2))},expand:function(a){$("#"+a).hasClass("prop-collapsed")?($("#"+a).removeClass("prop-collapsed"),$("#"+a).addClass("prop-expanded"),$("#div"+a).css({display:"block"})):($("#"+a).removeClass("prop-expanded"),$("#"+a).addClass("prop-collapsed"),
$("#div"+a).css({display:"none"}))},forms:{},treeSelect:function(a){if($("#tree").tree("isLeaf",a.target))if($("#tabs").tabs("getTab",a.text))$("#tabs").tabs("select",a.text);else{if(-1<a.attributes.link1.indexOf("/")){var b=Object.create(simpleHtml);b.page=a.attributes.link1}else if("RegulationPrint.Tools.TLDocs"==a.attributes.link1)b=Object.create(TLDocs);else if("tariffs"==a.attributes.link1)b=Object.create(tariffs);else if("RegulationPrint.Tools.TLVins"==a.attributes.link1||"RegulationPrint.US.USStoreFinder"==
a.attributes.link1)b=Object.create(TLVins);else if("Bureau.Access"==a.attributes.link1)b=Object.create(Access);else if("RegulationPrint.Dgs.groupSubs"==a.attributes.link1)b=Object.create(AccessDgs);else if("1465"==a.attributes.params)b=Object.create(fi_declare);else if("1444"==a.attributes.params)b=Object.create(fi_contractors);else if("1445"==a.attributes.params)b=Object.create(fi_agreements);else if("1451"==a.attributes.params)b=Object.create(FlightCardsList);else if("1453"==a.attributes.params)b=
Object.create(DaDataLoads);else if("porders"==a.attributes.link1)b=new Poo;else if(a.attributes.params)b=Object.create(finder);else return;b.absid="app.forms.form"+a.id.toString();b.node=a.id.toString();b.IdDeclare=a.attributes.params;b.SQLParams={};b.DefaultValues={};b.DefaultValues.last_change_user=app.account;b.DefaultValues.audtuser=app.account;app.forms["form"+a.id.toString()]=b;var c=b.template();$("#tabs").tabs("add",{title:a.text,content:c,closable:!0,selected:!0,iconCls:a.iconCls,fit:!0});
b.start()}else $("#tree").tree("toggle",a.target)},t_sysfieldmap:[],start:function(){$("#main").panel({fit:!0,href:"content.html",onLoad:function(){app.init()}})},init:function(){$("#tree").tree({fit:!0,url:"ustore/gettree",method:"post",onSelect:this.treeSelect,onLoadSuccess:function(a,b){$.post("/pg/runsql",{sql:"select  idmap, decname, dstfield, srcfield, iddeclare, classname, groupdec, keyfield from t_sysfieldmap"},function(a){a.message?$.messager.alert("\u041e\u0448\u0438\u0431\u043a\u0430.",
a.message,"error"):(app.t_sysfieldmap=a.rows,app.startid&&(a=$("#tree").tree("find",app.startid),$("#tree").tree("select",a.target)))})}});$("#tabs").tabs({fit:!0})},showLink:function(a,b,c){if($("#tabs").tabs("getTab",a))$("#tabs").tabs("select",a);else{var d=Object.create(simpleHtml);d.page=c;d.absid="app.forms.form"+b.toString();d.node=b.toString();app.forms["form"+b.toString()]=d;b=d.template();$("#tabs").tabs("add",{title:a,content:b,closable:!0,selected:!0,fit:!0});d.start()}}},Access={__proto__:rootObj,
addAcc:function(a){var b=a.form.LeftTab.MainTab.datagrid("getSelected");if(b){var c=a.form.FreeTab.MainTab.datagrid("getSelected");c&&$.post("/pg/runsql",{sql:"exec p_sysAccesUser '"+b.ObjectName+"', '"+c.Account+"', 1"},function(b){a.form.FreeTab.ReloadTab(a.form.FreeTab);a.form.AccessTab.ReloadTab(a.form.AccessTab)})}},deleteAcc:function(a){var b=a.form.LeftTab.MainTab.datagrid("getSelected");if(b){var c=a.form.AccessTab.MainTab.datagrid("getSelected");c&&$.post("/pg/runsql",{sql:"exec p_sysAccesUser '"+
b.ObjectName+"', '"+c.ACCOUNT+"', 2"},function(b){a.form.FreeTab.ReloadTab(a.form.FreeTab);a.form.AccessTab.ReloadTab(a.form.AccessTab)})}},start:function(){this.AccessTab=Object.create(finder);this.AccessTab.SQLParams={};this.AccessTab.absid="AccessTab1010";this.AccessTab.IdDeclare="118";this.AccessTab.form=this;this.AccessTab.addInitGrid=function(a){$(a.id("maintab")).datagrid({onDblClickRow:function(b,c){a.form.deleteAcc(a)}})};this.AccessTab.start();this.FreeTab=Object.create(finder);this.FreeTab.SQLParams=
{};this.FreeTab.absid="FreeTab1010";this.FreeTab.IdDeclare="119";this.FreeTab.form=this;this.FreeTab.addInitGrid=function(a){$(a.id("maintab")).datagrid({toolbar:[{iconCls:"icon-up",text:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",handler:function(){a.form.addAcc(a)}},"-",{iconCls:"icon-down",text:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",handler:function(){a.form.deleteAcc(a)}}],onDblClickRow:function(b,c){a.form.addAcc(a)}})};this.FreeTab.start();this.LeftTab=Object.create(finder);this.LeftTab.SQLParams=
{};this.LeftTab.absid="LeftTab1010";this.LeftTab.IdDeclare="117";this.LeftTab.form=this;this.LeftTab.addInitGrid=function(a){};this.LeftTab.onSelect=function(a,b,c){c.form.AccessTab.SQLParams.ObjectName=b.ObjectName;c.form.AccessTab.UpdateTab(c.form.AccessTab);c.form.FreeTab.SQLParams.GRP=b.ObjectName;c.form.FreeTab.UpdateTab(c.form.FreeTab)};this.LeftTab.start()},template:function(){return $("#access").text()}},simpleHtml={__proto__:rootObj,start:function(){},page:"",template:function(){return'<div class="easyui-layout" fit="true"><div data-options="region:\'center\', split:false"><iframe crossorigin src="'+
(this.page+'" style = "height:100%;width:100%; border-width: 0"/></div></div>')}},finder={__proto__:rootObj,IdDeclare:0,columns:[],frozenColumns:[],prepareSQL:"",editor_class:tc_class,editor:{},pagination:!0,width:"800",height:"550",text:"\u041f\u043e\u0438\u0441\u043a",singleSelect:!0,show:function(a){a.win.window("open")},setSQLParams:function(a){a.prepareSQL=a.sql?a.sql:a.t_rpdeclare.decsql;for(var b in a.SQLParams){var c=a.SQLParams[b];c||(c="");c=c.replace(/'/g,"''");var d=new RegExp("@"+b,"g");
a.prepareSQL=a.prepareSQL.replace(d,"'"+c+"'");d=new RegExp(":"+b,"g");a.prepareSQL=a.prepareSQL.replace(d,"'"+c+"'");d=new RegExp("\\["+b+"\\]","g");a.prepareSQL=a.prepareSQL.replace(d,c)}},template:function(){return'<div class="easyui-layout" fit="true"><div data-options="region:\'center\', split:false"><table id="'+(this.idh("maintab")+'"></table></div></div>')},createOKhtml:function(){$(this.id("win")).remove();$(this.id("maintab")).remove();this.win=$('<div id="'+this.idh("win")+'" style="width:'+
this.width+"px;height:"+this.height+'px;padding:10px 10px 0px 10px"></div>').appendTo("body");var a=$("#okcancel").html();a=a.replace("OKFun",this.prop("okclick()"));a=a.replace("CloseFun",this.prop("cancelclick()"));var b='<table id="'+this.idh("maintab")+'"></table>';a=a.replace("Content",b);this.win.window({title:this.text,modal:!0,collapsible:!1,minimizable:!1,closed:!0,content:a})},okclicksender:function(a){},cancelclick:function(){this.win.window("close")},okclick:function(){this.OKFun(this)},
start:function(){this.OKFun&&this.createOKhtml();this.init();this.getcolumn()},UpdateTab:function(a){a.setSQLParams(a);a.MainTab.datagrid("load",{sql:a.prepareSQL,SumFields:a.SumFields,LabelField:a.LabelField,LabelText:a.LabelText,pagination:1})},ReloadTab:function(a){a.setSQLParams(a);a.MainTab.datagrid("reload",{sql:a.prepareSQL,SumFields:a.SumFields,LabelField:a.LabelField,LabelText:a.LabelText,pagination:1})},createColumns:function(a,b){if(a.message)console.debug(a.message);else{b.t_rpdeclare=
a.rows[0];app.isP&&(b.t_rpdeclare.decsql=b.t_rpdeclare.decsql.toLowerCase());b.setSQLParams(b);a=$.parseXML(b.t_rpdeclare.paramvalue);var c=$(a).find("GRID").attr("FROZENCOLS");b.SumFields=$(a).find("GRID").attr("SumFields");b.LabelField=$(a).find("GRID").attr("LabelField");b.LabelText=$(a).find("GRID").attr("LabelText");""==c&&(c="0");var d=Number(c),e=[],h=[],l=0;b.singleSelect||h.push({field:"is_closebit",checkbox:!0});$(a).find("COLUMN").each(function(){if("1"==$(this).attr("Visible")){var a=
"field_"+$(this).attr("FieldName").toLowerCase()+b.IdDeclare.toString();app.isP||(a="field_"+$(this).attr("FieldName")+b.IdDeclare.toString());(a=localStorage[a])||(a=$(this).attr("Width"));var c=function(a,b,c){return a};"image_bmp"==$(this).attr("FieldName").toLowerCase()&&(c=function(a,b,c){return a?'<img style="max-width:48px;max-height:48px" src="data:image/gif;base64,'+a+'"/>':a});$(this).attr("DisplayFormat")&&(c=function(a,b,c){return app.dateformat(a,this.DisplayFormat)});var p="left";-1<
$(this).attr("DisplayFormat").indexOf("#")&&(p="right");l<d?h.push({field:app.isP?$(this).attr("FieldName").toLowerCase():$(this).attr("FieldName"),title:$(this).attr("FieldCaption"),width:a,sortable:!0,DisplayFormat:$(this).attr("DisplayFormat"),align:p,formatter:c,group:$(this).attr("group")}):e.push({field:app.isP?$(this).attr("FieldName").toLowerCase():$(this).attr("FieldName"),title:$(this).attr("FieldCaption"),width:a,sortable:!0,DisplayFormat:$(this).attr("DisplayFormat"),align:p,formatter:c,
group:$(this).attr("group")});l++}});b.columns=e;b.frozenColumns=h;b.addInitGrid(b);b.initGrid(b)}},init:function(){},addInitGrid:function(a){if(a.OKFun)$(a.id("maintab")).datagrid({onDblClickRow:function(b,d){a.OKFun(a)}});else if(a.t_rpdeclare.editproc||a.t_rpdeclare.keyvalue)if(""!=a.t_rpdeclare.editproc||a.t_rpdeclare.keyvalue){var b=$('<div style="padding:2px 4px"></div>').appendTo("body");a.t_rpdeclare.editproc&&""!=a.t_rpdeclare.editproc&&(a.editor=Object.create(a.editor_class),a.editor.absid=
a.prop("editor"),a.editor.finder=a,a.editor.start(a.editor),a.abut=$("<a>").appendTo(b),a.ebut=$("<a>").appendTo(b),a.dbut=$("<a>").appendTo(b),a.abut.linkbutton({iconCls:"icon-add",text:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",plain:!0,onClick:function(){a.editor.addrecord(a.editor)}}),a.ebut.linkbutton({iconCls:"icon-edit",text:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c",plain:!0,onClick:function(){a.editor.editrecord(a.editor)}}),a.dbut.linkbutton({iconCls:"icon-cancel",
text:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",plain:!0,onClick:function(){a.editor.deleterecord(a.editor)}}));0<a.t_rpdeclare.keyvalue&&(a.lbut=$("<a>").appendTo(b),a.lbut.linkbutton({iconCls:"tree-file",text:"\u0421\u0442\u0440\u043e\u043a\u0438",plain:!0,onClick:function(){var b=a.MainTab.datagrid("getSelected");if(b){var d=a.t_rpdeclare.descr+"_"+b[a.t_rpdeclare.dispfield].toString(),e=a.t_rpdeclare.descr+"_"+b[a.t_rpdeclare.keyfield].toString();d=d.replace(/-/g,"_").replace(/ /g,"_");e=e.replace(/-/g,
"_").replace(/ /g,"_");if($("#tabs").tabs("getTab",d))$("#tabs").tabs("select",d);else{var h=Object.create(finder);h.absid="app.forms.form"+e.toString();h.node=e.toString();h.IdDeclare=a.t_rpdeclare.keyvalue;h.SQLParams={};h.DefaultValues={};h.SQLParams.Account=app.account;h.SQLParams[a.t_rpdeclare.keyfield]=b[a.t_rpdeclare.keyfield].toString();h.DefaultValues[a.t_rpdeclare.keyfield]=b[a.t_rpdeclare.keyfield].toString();h.DefaultValues.last_change_user=app.account;h.DefaultValues.audtuser=app.account;
app.forms["form"+e.toString()]=h;b=h.template();$("#tabs").tabs("add",{title:d,content:b,closable:!0,selected:!0,fit:!0});h.start()}}else $.messager.alert(a.t_rpdeclare.descr,"\u0412\u044b\u0431\u0435\u0440\u0435\u0442\u0435 \u0437\u0430\u043f\u0438\u0441\u044c","info")}}));a.addTool(a,b);$(a.id("maintab")).datagrid({toolbar:b,onDblClickRow:function(b,d){a.editor.editrecord(a.editor)}})}},addTool:function(a,b){},onSelect:function(a,b,c){},onInitGrid:function(a){},initGrid:function(a){a.MainTab=$(a.id("maintab"));
a.MainTab.datagrid({url:"/pg/runsql",method:"POST",queryParams:{sql:a.prepareSQL,SumFields:a.SumFields,LabelField:a.LabelField,LabelText:a.LabelText,pagination:1},columns:[a.columns],frozenColumns:[a.frozenColumns],fit:!0,singleSelect:a.singleSelect,idField:a.t_rpdeclare.keyfield,pagination:a.pagination,pageNumber:1,pageSize:30,pageList:[30,50,100],remoteSort:!0,multiSort:!0,remoteFilter:!0,showFooter:!0,onResizeColumn:function(b,c){localStorage["field_"+b+a.IdDeclare.toString()]=c},rowStyler:function(a,
c){if(c.color)return"background-color: "+app.colorParse(c.color);if(c.Color)return"background-color: "+app.colorParse(c.Color)},onSelect:function(b,c){$(".datagrid-row-selected").removeAttr("style");this.rowselect=c;a.onSelect(b,c,a)},onBeforeSelect:function(a,c){this.rowselect&&(this.rowselect.color&&$(".datagrid-row-selected").css({background:app.colorParse(this.rowselect.color)}),this.rowselect.Color&&$(".datagrid-row-selected").css({background:app.colorParse(this.rowselect.Color)}))}});a.pagination&&
a.MainTab.datagrid("enableFilter");a.onInitGrid(a)},getcolumn:function(){var a="select iddeclare, decname, descr, dectype, decsql, keyfield, dispfield, keyvalue, dispvalue, keyparamname, dispparamname, isbasename, descript, addkeys, tablename, editproc, delproc, image_bmp, savefieldlist, p.paramvalue from t_rpdeclare d left join t_sysparams p on 'GridFind' || d.decname = p.paramname where iddeclare = "+this.IdDeclare.toString(),b=new FormData;b.append("sql",a);var c=this.createColumns,d=this;fetch("/pg/runsql",
{method:"POST",body:b}).then(function(a){return a.json()}).then(function(a){c(a,d)})}},fi_declare={__proto__:finder,editor_class:declare_editor};var po_editor={__proto__:tc_class,detailIdDec:0,masterField:"",detailField:"",onEdit:function(a){a.detail.SQLParams={};a.detail.DefaultValues={};a.detail.SQLParams[a.detailField]=a.record[a.masterField].toString();a.detail.DefaultValues[a.detailField]=a.record[a.masterField].toString();a.detail.UpdateTab(a.detail)},htmlContent:function(a,b){$(a.id("winedit")).remove();$(a.id("detail_maintab")).remove();for(var c=0;c<a.fields.length;c++)$(a.id(a.fields[c].field)).remove();a.winedit=$('<div id="'+a.idh("winedit")+
'" style="width:1200px;height:550px;padding:10px 10px 0px 10px"></div>').appendTo("body");c='<table id="'+a.idh("detail_maintab")+'"></table>';var d=$("#leftright").html();d=d.replace("OKFun",a.prop("okclick"));d=d.replace("CloseFun",a.prop("cancelclick"));d=d.replace("leftContent",b);return d=d.replace("rigthContent",c)},onStart:function(a){a.detail=Object.create(finder);a.detail.absid=a.prop("detail");a.detail.editform=a;a.detail.IdDeclare=a.detailIdDec;a.detail.start()}},porders={__proto__:finder,
editor_class:po_editor};Poo=function(){var a=Object.create(porders);a.editor_class.detailIdDec=135;a.editor_class.masterField="po_pk";a.editor_class.detailField="pd_po";return a};
var tariffs={__proto__:finder,handleFiles:function(a){if(a.length){var b=this.MainTab.datagrid("getSelected"),c=new FormData;c.append("nn",b.nn.toString());c.append("tfile",a[0]);$.ajax({async:!0,url:"/tffile",method:"POST",processData:!1,contentType:!1,mimeType:"multipart/form-data",data:c}).done(function(a){$.messager.alert("\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0444\u0430\u0439\u043b\u0430",a,"info")});$("#tariffile").val("")}},addInitGrid:function(a){var b=$('<div style="padding:2px 4px"></div>').appendTo("body");
a.abut=$("<a>").appendTo(b);a.ebut=$("<a>").appendTo(b);a.dbut=$("<a>").appendTo(b);a.fbut=$("<a>").appendTo(b);a.lbut=$("<a>").appendTo(b);a.file=$('<input type="file" id="tariffile" style="display:none" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" onchange="'+a.prop("handleFiles(this.files)")+'"/>').appendTo(b);a.dlbut=$("<a>").appendTo(b);a.runbut=$("<a>").appendTo(b);a.exbut=$("<a>").appendTo(b);a.editor=Object.create(tc_class);a.editor.absid=a.prop("editor");a.editor.finder=
a;a.editor.start(a.editor);a.abut.linkbutton({iconCls:"icon-add",text:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",plain:!0,onClick:function(){a.editor.addrecord(a.editor)}});a.ebut.linkbutton({iconCls:"icon-edit",text:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c",plain:!0,onClick:function(){a.editor.editrecord(a.editor)}});a.dbut.linkbutton({iconCls:"icon-cancel",text:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",plain:!0,onClick:function(){a.editor.deleterecord(a.editor)}});
a.lbut.linkbutton({iconCls:"tree-file",text:"\u0421\u0442\u0440\u043e\u043a\u0438",plain:!0,onClick:function(){var b=a.MainTab.datagrid("getSelected");if(b){var d=b.al_utg+" "+b.tf_datebeg.toString().substr(0,10),e="tf_"+b.nn.toString();if($("#tabs").tabs("getTab",d))$("#tabs").tabs("select",d);else{var h=Object.create(finder);h.absid="app.forms.form"+e.toString();h.node=e.toString();h.IdDeclare=134;h.SQLParams={};h.DefaultValues={};h.SQLParams.nn=b.nn.toString();h.DefaultValues.nn=b.nn.toString();
app.forms["form"+e.toString()]=h;b=h.template();$("#tabs").tabs("add",{title:d,content:b,closable:!0,selected:!0,fit:!0});h.start()}}else $.messager.alert(a.t_rpdeclare.descr,"\u0412\u044b\u0431\u0435\u0440\u0435\u0442\u0435 \u0437\u0430\u043f\u0438\u0441\u044c","info")}});a.fbut.linkbutton({iconCls:"icon-magic",text:"\u0424\u0430\u0439\u043b",plain:!0,onClick:function(){a.MainTab.datagrid("getSelected")?a.file.click():$.messager.alert(a.t_rpdeclare.descr,"\u0412\u044b\u0431\u0435\u0440\u0435\u0442\u0435 \u0437\u0430\u043f\u0438\u0441\u044c",
"info")}});a.dlbut.linkbutton({iconCls:"icon-download",text:"\u042d\u043a\u0441\u043f\u043e\u0440\u0442 (sql)",plain:!0,onClick:function(){var b=a.MainTab.datagrid("getSelected");b?window.document.location="/pg/tariffs/"+b.nn.toString():$.messager.alert(a.t_rpdeclare.descr,"\u0412\u044b\u0431\u0435\u0440\u0435\u0442\u0435 \u0437\u0430\u043f\u0438\u0441\u044c","info")}});a.runbut.linkbutton({iconCls:"icon-download",text:"\u042d\u043a\u0441\u043f\u043e\u0440\u0442 (uSmart)",plain:!0,onClick:function(){var b=
a.MainTab.datagrid("getSelected");b?$.messager.confirm({title:"\u042d\u043a\u0441\u043f\u043e\u0440\u0442 \u0442\u0430\u0440\u0438\u0444\u043e\u0432",msg:"\u041f\u0435\u0440\u0435\u043d\u0435\u0441\u0442\u0438 \u0434\u0430\u043d\u043d\u044b\u0435 \u0432 \u0441\u043f\u0440\u0430\u0432\u043e\u0447\u043d\u0438\u043a uSmart?",fn:function(a){a&&$.post("/pg/runtariffs/"+b.nn.toString(),{},function(a){$.messager.alert("\u042d\u043a\u0441\u043f\u043e\u0440\u0442 \u0442\u0430\u0440\u0438\u0444\u043e\u0432",
a,"info")})},ok:"\u0414\u0430",cancel:"\u041d\u0435\u0442"}):$.messager.alert(a.t_rpdeclare.descr,"\u0412\u044b\u0431\u0435\u0440\u0435\u0442\u0435 \u0437\u0430\u043f\u0438\u0441\u044c","info")}});a.exbut.linkbutton({iconCls:"icon-download",text:"\u042d\u043a\u0441\u043f\u043e\u0440\u0442 (xlsx)",plain:!0,onClick:function(){var b=a.MainTab.datagrid("getSelected");b?window.document.location="/pg/excel/"+b.nn.toString():$.messager.alert(a.t_rpdeclare.descr,"\u0412\u044b\u0431\u0435\u0440\u0435\u0442\u0435 \u0437\u0430\u043f\u0438\u0441\u044c",
"info")}});$(a.id("maintab")).datagrid({toolbar:b,onDblClickRow:function(b,d){a.editor.editrecord(a.editor)}})}};var contractors_editor={__proto__:tc_class,onStart:function(a){$(a.id("contractor_inn")).textbox({icons:[{iconCls:"icon-search",handler:function(b){if(b=a.record.contractor_inn)b="/usmart/getcntinfo/"+b.split("/")[0],$.get(b,function(b){if(0!=b.suggestions.length){b=b.suggestions[0].data;var c=a.id("contractor_full_name");$(c).textbox("setValue",b.name.short_with_opf);c=a.id("contractor_alias");$(c).textbox("setValue",b.name.short);c=a.id("contractor_post_address");$(c).textbox("setValue",b.address.data.postal_code+
", "+b.address.value)}})}}]})}},fi_contractors={__proto__:finder,editor_class:contractors_editor,addTool:function(a,b){a.combut=$("<a>").appendTo(b);a.combut.linkbutton({iconCls:"tree-file",text:"\u0417\u0430\u043c\u0435\u0447\u0430\u043d\u0438\u044f",plain:!0,onClick:function(){var b=a.MainTab.datagrid("getSelected");b?app.showLink("\u0417\u0430\u043c\u0435\u0447\u0430\u043d\u0438\u044f(\u043a\u043e\u043d\u0442\u0440\u0430\u0433\u0435\u043d\u0442\u044b) "+b.contractor_id.toString(),"contractor_id_"+
b.contractor_id.toString(),"/Docfiles/comments?ag_id="+b.contractor_id.toString()+"&ag_type=cnt"):$.messager.alert(a.t_rpdeclare.descr,"\u0412\u044b\u0431\u0435\u0440\u0435\u0442\u0435 \u0437\u0430\u043f\u0438\u0441\u044c","info")}})}},fi_agreements={__proto__:finder,addTool:function(a,b){a.lbut=$("<a>").appendTo(b);a.lbut.linkbutton({iconCls:"tree-file",text:"\u0424\u0430\u0439\u043b\u044b",plain:!0,onClick:function(){var b=a.MainTab.datagrid("getSelected");b?app.showLink("\u0424\u0430\u0439\u043b\u044b "+
b.agr_key.toString(),"agr_"+b.agr_key.toString(),"/Docfiles/dir?id="+b.agr_key.toString()+"/"):$.messager.alert(a.t_rpdeclare.descr,"\u0412\u044b\u0431\u0435\u0440\u0435\u0442\u0435 \u0437\u0430\u043f\u0438\u0441\u044c","info")}});a.combut=$("<a>").appendTo(b);a.combut.linkbutton({iconCls:"tree-file",text:"\u0417\u0430\u043c\u0435\u0447\u0430\u043d\u0438\u044f",plain:!0,onClick:function(){var b=a.MainTab.datagrid("getSelected");b?app.showLink("\u0417\u0430\u043c\u0435\u0447\u0430\u043d\u0438\u044f "+
b.agr_key.toString(),"agr_"+b.agr_key.toString(),"/Docfiles/comments?ag_id="+b.agr_key.toString()+"&ag_type=agr"):$.messager.alert(a.t_rpdeclare.descr,"\u0412\u044b\u0431\u0435\u0440\u0435\u0442\u0435 \u0437\u0430\u043f\u0438\u0441\u044c","info")}})}},DaDataLoads={__proto__:finder,handleFiles:function(a){if(a.length){var b=new FormData;b.append("img",a[0]);sender=this;$.ajax({type:"POST",url:"/DaData/upload",processData:!1,contentType:!1,data:b,success:function(a){$("#tariffile").val("");a.error?
$.messager.alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u043a\u0438 \u0444\u0430\u0439\u043b\u0430",a.error,"error"):sender.UpdateTab(sender)}})}},addInitGrid:function(a){var b=$('<div style="padding:2px 4px"></div>').appendTo("body");a.file=$('<input type="file" id="tariffile" style="display:none" accept="text/txt" onchange="'+a.prop("handleFiles(this.files)")+'"/>').appendTo(b);a.fbut=$("<a>").appendTo(b);a.fbut.linkbutton({iconCls:"icon-add",text:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",
plain:!0,onClick:function(){a.file.click()}});$(a.id("maintab")).datagrid({toolbar:b})}},FlightCardsList={__proto__:finder,init:function(){var a=new Date;this.SQLParams={};this.SQLParams.FC_Date=a.getFullYear().toString()+"-"+(a.getMonth()+1).toString()+"-"+a.getDate().toString();this.startdate=0},addInitGrid:function(a){var b=$('<div style="padding:2px 4px" align="right"></div>').appendTo("body");$("<span> <b>\u0414\u0430\u0442\u0430 \u0440\u0435\u0439\u0441\u0430:</b> </span>").appendTo(b);a.fc_date=
$("<input>").appendTo(b);a.fc_date.width(100);a.fc_date.datebox({onChange:function(b,c){1==a.startdate?(a.SQLParams.FC_Date=app.dateparser(b),a.UpdateTab(a)):a.startdate=1}});var c=new Date;c=c.getDate().toString()+"."+(c.getMonth()+1).toString()+"."+c.getFullYear().toString();a.fc_date.datebox("setValue",c);$(a.id("maintab")).datagrid({toolbar:b})}},AccessDgs={__proto__:rootObj,addAcc:function(a){var b=a.form.LeftTab.MainTab.datagrid("getSelected");if(b){var c=a.form.FreeTab.MainTab.datagrid("getSelected");
c&&$.post("/pg/runsql",{sql:"exec p_cnt_subsGroups_Subscribers_EDIT '"+b.grp+"', '"+c.Account+"'"},function(b){a.form.FreeTab.ReloadTab(a.form.FreeTab);a.form.AccessTab.ReloadTab(a.form.AccessTab)})}},deleteAcc:function(a){var b=a.form.LeftTab.MainTab.datagrid("getSelected");if(b){var c=a.form.AccessTab.MainTab.datagrid("getSelected");c&&$.post("/pg/runsql",{sql:"exec p_cnt_subsGroups_Subscribers_DEL '"+b.grp+"', '"+c.Account+"'"},function(b){a.form.FreeTab.ReloadTab(a.form.FreeTab);a.form.AccessTab.ReloadTab(a.form.AccessTab)})}},
start:function(){this.AccessTab=Object.create(finder);this.AccessTab.SQLParams={};this.AccessTab.absid="AccessTab1010";this.AccessTab.IdDeclare="1458";this.AccessTab.form=this;this.AccessTab.addInitGrid=function(a){$(a.id("maintab")).datagrid({onDblClickRow:function(b,c){a.form.deleteAcc(a)}})};this.AccessTab.start();this.FreeTab=Object.create(finder);this.FreeTab.SQLParams={};this.FreeTab.absid="FreeTab1010";this.FreeTab.IdDeclare="1459";this.FreeTab.form=this;this.FreeTab.addInitGrid=function(a){$(a.id("maintab")).datagrid({toolbar:[{iconCls:"icon-up",
text:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",handler:function(){a.form.addAcc(a)}},"-",{iconCls:"icon-down",text:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",handler:function(){a.form.deleteAcc(a)}}],onDblClickRow:function(b,c){a.form.addAcc(a)}})};this.FreeTab.start();this.LeftTab=Object.create(finder);this.LeftTab.SQLParams={};this.LeftTab.absid="LeftTab1010";this.LeftTab.IdDeclare="1457";this.LeftTab.form=this;this.LeftTab.addInitGrid=function(a){};this.LeftTab.onSelect=function(a,b,
c){c.form.AccessTab.SQLParams.grp=b.grp;c.form.AccessTab.UpdateTab(c.form.AccessTab);c.form.FreeTab.SQLParams.grp=b.grp;c.form.FreeTab.UpdateTab(c.form.FreeTab)};this.LeftTab.start()},template:function(){return $("#access").text()}};
