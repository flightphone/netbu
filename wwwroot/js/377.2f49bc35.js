"use strict";(self["webpackChunkvue2a_test"]=self["webpackChunkvue2a_test"]||[]).push([[377],{377:function(t,e,i){i.d(e,{Z:function(){return K}});var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{hidden:!t.visible}},[i("v-dialog",{attrs:{persistent:""},model:{value:t.openFilter,callback:function(e){t.openFilter=e},expression:"openFilter"}},[i("v-card",[i("v-card-title",[t._v("Фильтровка и сортировка")]),i("div",{staticStyle:{height:"60vh",maxheight:"60vh",overflow:"auto"}},[t.load?t._e():i("v-simple-table",{attrs:{dense:"",light:""},scopedSlots:t._u([{key:"default",fn:function(){return[i("tbody",t._l(t.OpenMapData().Fcols,(function(e,a){return i("tr",{key:e.FieldName,staticStyle:{"background-color":"white"}},[i("td",{staticStyle:{"border-bottom":"none"}},[i("v-text-field",{attrs:{label:e.FieldCaption,"append-icon":t.getIcon(e)},on:{"click:append":function(i){return t.sortChangeIndex(e,a)}},model:{value:e.FindString,callback:function(i){t.$set(e,"FindString",i)},expression:"column.FindString"}})],1),i("td",{staticStyle:{"border-bottom":"none",width:"50px"}},[t._v(" "+t._s(e.SortOrder)+" "),i("span",{attrs:{hidden:""}},[t._v(t._s(t.rangSort))]),i("span",{attrs:{hidden:""}},[t._v(t._s(t.nactord))])])])})),0)]},proxy:!0}],null,!1,283315501)})],1),i("v-card-actions",[i("v-spacer"),i("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(e){return t.updateTab()}}},[t._v("ОК")]),i("v-btn",{attrs:{color:"green darken-1",text:""},on:{click:function(e){return t.setFilter(!1)}}},[t._v("Отмена")])],1)],1)],1),i("div",{attrs:{hidden:"grid"!=t.mode}},[t.stateDrawer?t._e():i("v-toolbar",{attrs:{flat:""}},[t.nupdate>0?i("v-toolbar-title",[t._v(t._s(t.Descr))]):t._e(),i("v-spacer"),i("v-spacer"),i("v-spacer"),t.load?t._e():i("v-text-field",{attrs:{label:"Поиск",dense:"",filled:"",rounded:"","hide-details":"","prepend-inner-icon":"mdi-magnify","single-line":""},on:{input:function(e){return t.updateTab()}},model:{value:t.OpenMapData().Fcols[t.dispIndex].FindString,callback:function(e){t.$set(t.OpenMapData().Fcols[t.dispIndex],"FindString",e)},expression:"OpenMapData().Fcols[dispIndex].FindString"}}),null!=t.editid?[i("v-btn",{attrs:{icon:""},on:{click:function(e){return t.selectFinder(t.editid)}}},[i("v-icon",[t._v("mdi-check")])],1),i("v-btn",{attrs:{icon:""},on:{click:function(e){return t.clearFinder()}}},[i("v-icon",[t._v("mdi-window-close")])],1)]:t._e(),t._t("default"),i("v-menu",{attrs:{left:""},scopedSlots:t._u([{key:"activator",fn:function(e){var a=e.on,n=e.attrs;return[i("v-btn",t._g(t._b({attrs:{icon:""}},"v-btn",n,!1),a),[i("v-icon",[t._v("mdi-dots-vertical")])],1)]}}],null,!1,3221905750)},[i("v-list",[i("v-list-item-group",[null!=t.editid||t.load?t._e():[t.OpenMapData().DelProc?i("v-list-item",{key:"6",on:{click:function(e){return t.add()}}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-plus")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Добавить")])],1)],1):t._e(),i("v-list-item",{key:"7",on:{click:function(e){return t.edit()}}},[i("v-list-item-icon",[t.OpenMapData().EditProc?i("v-icon",[t._v("mdi-pencil")]):i("v-icon",[t._v("mdi-magnify")])],1),i("v-list-item-content",[t.OpenMapData().EditProc?i("v-list-item-title",[t._v("Редактировать")]):i("v-list-item-title",[t._v("Просмотр")])],1)],1),t.OpenMapData().DelProc?i("v-list-item",{key:"8",on:{click:function(e){return t.confirmDelete()}}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-delete")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Удалить")])],1)],1):t._e()],t.load?t._e():[i("v-list-item",{key:"1",on:{click:function(e){return t.setFilter(!0)}}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-filter-menu")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Фильтровка и сортировка")])],1)],1),i("v-list-item",{key:"2",on:{click:function(e){t.stateDrawer=!0}}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-code-tags")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Страницы")])],1)],1),i("v-list-item",{key:"0",on:{click:function(e){return t.updateTab()}}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-refresh")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Обновить")])],1)],1)],null!=t.editid||t.load?t._e():[i("v-list-item",{key:"3",on:{click:function(e){return t.csv()}}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-cloud-download")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Экспорт в CSV")])],1)],1),t.OpenMapData().KeyValue?i("v-list-item",{key:"4",on:{click:function(e){return t.openDetail()}}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-details")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Детали")])],1)],1):t._e()],t.OpenMapData().IdDeclareSet&&!t.load?i("v-list-item",{key:"5",on:{click:function(e){return t.editSetting()}}},[i("v-list-item-icon",[i("v-icon",[t._v("mdi-cog")])],1),i("v-list-item-content",[i("v-list-item-title",[t._v("Параметры")])],1)],1):t._e()],2)],1)],1)],2),t.stateDrawer?i("Pagination",{attrs:{findData:t.OpenMapData()}}):t._e(),t.load?t._e():[t._t("table",(function(){return[t.load?t._e():i("v-simple-table",{attrs:{dense:"","fixed-header":"",height:t.gridHeight},scopedSlots:t._u([{key:"default",fn:function(){return[i("thead",[i("tr",t._l(t.OpenMapData().Fcols,(function(e){return i("th",{key:e.FieldName,staticClass:"caption",staticStyle:{"background-color":"LightGrey"}},[i("br"),t._v(t._s(e.FieldCaption))])})),0)]),t.nupdate>0?i("tbody",t._l(t.OpenMapData().MainTab,(function(e,a){return i("tr",{key:a,style:{"background-color":a==t.current?t.selectedColor:"white"},on:{click:function(e){return t.handleClick(a)}}},t._l(t.OpenMapData().Fcols,(function(a){return i("td",{key:a.FieldName,staticClass:"caption"},[t._v(t._s(""==a.DisplayFormat?e[a.FieldName]:t.dateformat(e[a.FieldName],a.DisplayFormat)))])})),0)})),0):t._e()]},proxy:!0}],null,!1,1400174965)})]}))]],2),i("div",{attrs:{hidden:!("edit"==t.mode||"add"==t.mode)}},[null!=t.editid||t.load?t._e():i("Editor",{attrs:{save:t.save,closeEditor:t.closeEditor,action:t.mode,findData:t.OpenMapData(),uid:t.uid,readonly:!t.OpenMapData().EditProc}},[t._t("editor")],2)],1),i("div",{attrs:{hidden:!("setting"==t.mode)}},[t.OpenMapData().IdDeclareSet&&!t.load?i("Editor",{attrs:{save:t.saveSetting,closeEditor:t.closeEditor,action:t.mode,findData:t.OpenMapData().Setting,uid:t.uid2}}):t._e()],1)],1)},n=[],o=i(5767),r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-toolbar",{attrs:{flat:"","max-width":"100vw"}},[i("span",{attrs:{hidden:""}},[t._v(t._s(t.$parent.action))]),t._v(" "+t._s(t.page()*t.nrows()+1)+" - "+t._s(Math.min((t.page()+1)*t.nrows(),t.count()))+" из "+t._s(t.count())+" "),i("v-spacer"),i("v-btn",{attrs:{icon:"",disabled:0===t.page()},on:{click:function(e){return t.$parent.onChangePage(0)}}},[i("v-icon",[t._v("mdi-page-first")])],1),i("v-btn",{attrs:{icon:"",disabled:0===t.page()},on:{click:function(e){t.$parent.onChangePage(t.page()-1)}}},[i("v-icon",[t._v("mdi-chevron-left")])],1),t._v(" "+t._s(t.page()+1)+" из "+t._s(Math.max(0,Math.ceil(t.count()/t.nrows())-1)+1)+" "),i("v-btn",{attrs:{icon:"",disabled:t.page()>=Math.ceil(t.count()/t.nrows())-1},on:{click:function(e){t.$parent.onChangePage(t.page()+1)}}},[i("v-icon",[t._v("mdi-chevron-right")])],1),i("v-btn",{attrs:{icon:"",disabled:t.page()>=Math.ceil(t.count()/t.nrows())-1},on:{click:function(e){t.$parent.onChangePage(Math.max(0,Math.ceil(t.count()/t.nrows())-1))}}},[i("v-icon",[t._v("mdi-page-last")])],1),i("v-btn",{attrs:{icon:""},on:{click:function(e){t.$parent.stateDrawer=!1}}},[i("v-icon",[t._v("mdi-window-close")])],1)],1)},s=[],d={name:"PaginationSmart",data:()=>({rowsPerPage:30}),props:{findData:Object},methods:{OpenMapData:function(){return this.findData},count:function(){return this.OpenMapData().TotalTab?this.OpenMapData().TotalTab[0].n_total:0},page:function(){return this.OpenMapData().page?this.OpenMapData().page-1:0},nrows:function(){return this.OpenMapData().nrows?this.OpenMapData().nrows:30}}},l=d,c=i(1001),u=i(3453),p=i.n(u),m=i(680),h=i(6428),f=i(3631),v=i(6656),D=(0,c.Z)(l,r,s,!1,null,null,null),g=D.exports;p()(D,{VBtn:m.Z,VIcon:h.Z,VSpacer:f.Z,VToolbar:v.Z});var w=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{attrs:{hidden:"edit"!=t.mode}},[i("v-toolbar",{attrs:{dense:"",flat:""}},[i("v-toolbar-title",[t._v(t._s(t.Descr()))]),i("v-spacer"),t.readonly?t._e():i("v-btn",{attrs:{icon:""},on:{click:function(e){return t.save()}}},[i("v-icon",[t._v("mdi-check")])],1),i("v-btn",{attrs:{icon:""},on:{click:function(e){return t.closeEditor()}}},[i("v-icon",[t._v("mdi-window-close")])],1)],1),t._t("default",(function(){return[i("v-simple-table",{scopedSlots:t._u([{key:"default",fn:function(){return[t.nupdate>0&&""!=t.uid?i("tbody",[t.readonly?t._l(t.findData.Fcols,(function(e,a){return i("tr",{key:a,staticStyle:{"background-color":"white"}},[i("td",{staticStyle:{"border-bottom":"none"}},[i("v-text-field",{key:e.FieldName+t.uid,attrs:{label:e.FieldCaption,value:t.findData.WorkRow[e.FieldName],readonly:""}})],1)])})):t._l(t.findData.ReferEdit.Editors,(function(e,a){return i("tr",{key:a,staticStyle:{"background-color":"white"}},[i("td",{staticStyle:{"border-bottom":"none"}},[null==e.joinRow?i("v-text-field",{key:e.FieldName+t.uid,attrs:{label:e.FieldCaption},model:{value:t.OpenMapData().WorkRow[e.FieldName],callback:function(i){t.$set(t.OpenMapData().WorkRow,e.FieldName,i)},expression:"OpenMapData().WorkRow[column.FieldName]"}}):["Bureau.Finder"==e.joinRow.classname?i("v-text-field",{key:e.FieldName+t.uid,attrs:{label:e.FieldCaption,"append-icon":"mdi-magnify",readonly:""},on:{"click:append":function(e){return t.open(a)}},model:{value:t.OpenMapData().WorkRow[e.FieldName],callback:function(i){t.$set(t.OpenMapData().WorkRow,e.FieldName,i)},expression:"OpenMapData().WorkRow[column.FieldName]"}}):t._e(),"Bureau.GridCombo"==e.joinRow.classname?i("v-select",{key:e.FieldName+t.uid,attrs:{label:e.FieldCaption,items:e.joinRow.FindConrol.MainTab,"item-value":e.joinRow.keyField,"item-text":e.joinRow.FindConrol.DispField},on:{change:function(i){return t.sortChange(i,e)}},model:{value:t.OpenMapData().WorkRow[e.joinRow.valField],callback:function(i){t.$set(t.OpenMapData().WorkRow,e.joinRow.valField,i)},expression:"OpenMapData().WorkRow[column.joinRow.valField]"}}):t._e()]],2)])}))],2):t._e()]},proxy:!0}])})]}))],2),t.readonly?t._e():[t._l(t.findData.ReferEdit.Editors,(function(e,a){return[null!=e.joinRow?["Bureau.Finder"==e.joinRow.classname?i("Finder",{key:a,attrs:{visible:t.mode=="finder_"+a.toString(),params:e.joinRow.IdDeclare,editid:a,findData:e.joinRow.FindConrol,selectFinder:t.selectFinder,clearFinder:t.clearFinder}}):t._e()]:t._e()]}))]],2)},F=[],b={name:"EditorCore",data:()=>({mode:"edit",mainObj:o.uW,nupdate:1}),props:{save:Function,closeEditor:Function,action:String,findData:Object,uid:String,readonly:Boolean},beforeCreate:function(){this.$options.components.Finder=i(377).Z},updated:function(){window.scroll(0,this.OpenMapData().scroll)},methods:{OpenMapData:function(){return this.findData},Descr:function(){return"add"==this.action?"Новая запись ("+this.findData.Descr+")":"edit"==this.action?this.readonly?"Просмотр ("+this.findData.Descr+")":"Редактирование ("+this.findData.Descr+")":"setting"==this.action?"Параметры ("+this.findData.Descr+")":void 0},open:function(t){this.OpenMapData().scroll=window.scrollY,this.mode="finder_"+t.toString()},selectFinder:function(t){let e=this.findData.ReferEdit.Editors[t],i=this.findData.ReferEdit.Editors[t].joinRow.FindConrol.curRow,a=e.joinRow.FindConrol.MainTab[i];for(let n in e.joinRow.fields)this.OpenMapData().WorkRow[e.joinRow.fields[n]]=a[n];this.nupdate=this.nupdate+1,this.mode="edit"},sortChange:function(t,e){e.joinRow.FindConrol.MainTab.map((i=>{if(i[e.joinRow.keyField]==t)for(let t in e.joinRow.fields)this.OpenMapData().WorkRow[e.joinRow.fields[t]]=i[t]})),this.nupdate=this.nupdate+1},clearFinder:function(){this.mode="edit"},textChange:function(t,e){this.OpenMapData().WorkRow[e]=t}}},k=b,_=i(5340),S=i(3568),M=i(5978),y=i(7921),O=(0,c.Z)(k,w,F,!1,null,null,null),R=O.exports;p()(O,{VBtn:m.Z,VIcon:h.Z,VSelect:_.Z,VSimpleTable:S.Z,VSpacer:f.Z,VTextField:M.Z,VToolbar:v.Z,VToolbarTitle:y.qW});let T={name:"FinderCore",components:{Pagination:g,Editor:R},data:()=>({mainObj:o.uW,openMap:o.M8,load:!0,mode:"grid",Descr:"Загрузка...",current:0,stateDrawer:!1,action:1,nupdate:1,nadd:1,nactord:1,items:["Нет","ASC","DESC"],rangSort:0,uid:"xx",uid2:"yy",selectedColor:o.uW.selectedColor,openFilter:!1,dispIndex:0,gridHeight:o.uW.gridHeight()}),props:{visible:{type:Boolean,required:!0},id:String,params:String,editid:Number,findData:Object,selectFinder:Function,clearFinder:Function},computed:{finderRowStyle:function(){}},methods:{resize:function(){this.gridHeight=o.uW.gridHeight()},sortChange:function(t,e){let i=0,a=this.OpenMapData().Fcols;a.map(((t,a)=>{"Нет"==t.Sort&&(t.SortOrder=null),a!=e&&t.SortOrder&&t.SortOrder>i&&(i=t.SortOrder)})),a[e].SortOrder=i+1,this.rangSort=i+1,this.nactord=this.nactord+1},sortChangeIndex:function(t,e){"ASC"==t.Sort?t.Sort="DESC":"DESC"==t.Sort?t.Sort="Нет":t.Sort="ASC",this.sortChange(null,e)},getIcon:function(t){return"ASC"==t.Sort?"mdi-arrow-down":"DESC"==t.Sort?"mdi-arrow-up":"mdi-sort"},dateformat:function(t,e){return o.uW.dateformat(t,e)},OpenMapData:function(){return null!=this.id?(null==o.M8.get(this.id)&&o.M8.set(this.id,{Control:null,Params:this.params,SQLParams:null,data:{}}),o.M8.get(this.id).data):this.findData},OpenMapId:function(){return null==o.M8.get(this.id)&&o.M8.set(this.id,{Control:null,Params:this.params,SQLParams:null,data:{}}),o.M8.get(this.id)},setLoad:function(t){this.load=t},setFilter:function(t){this.openFilter=t},handleClick:function(t){this.OpenMapData().curRow==t?(this.current=t,null==this.editid?this.OpenMapData().EditProc?this.edit():this.OpenMapData().KeyValue?this.openDetail():this.edit():this.selectFinder(this.editid)):(this.OpenMapData().curRow=t,this.current=t)},openDetail:function(){let t=this.OpenMapData();if(null==t.curRow)return;let e,i,a,n=t.MainTab[t.curRow],r={};if(n["iddeclare"]&&n["keyf"]){let t=n["keyf"],o=n["dispfield"],s=n["iddeclare"];e=n[t],r[t]=e,i=s,a=n[o]}else e=n[t.KeyF],r[t.KeyF]=e,i=t.KeyValue,a=n[t.DispField];let s={Control:null,Params:i,TextParams:r,title:a,data:{}},d=this.id+"_"+n[t.KeyF];null==o.M8.get(d)&&o.M8.set(d,s),this.$router.push({path:"/account/finder",query:{id:d,params:i}})},csv:function(){const t=o.FH+"React/csv";let e=new FormData,i=this.OpenMapData();const a=this.params;e.append("id",a),e.append("Fc",JSON.stringify(i.Fcols)),i.SQLParams&&e.append("SQLParams",JSON.stringify(i.SQLParams)),i.TextParams&&e.append("TextParams",JSON.stringify(i.TextParams)),fetch(t,{method:"POST",mode:o.W6?"no-cors":"cors",cache:"no-cache",credentials:o.W6?"include":"omit",body:e}).then((t=>t.blob())).then((t=>{let e=document.createElement("a");e.href=URL.createObjectURL(t),e.setAttribute("download","data.csv"),e.click()}))},loadFile:function(){let t=this.OpenMapData();if(null==t.curRow)return;let e=t.MainTab[t.curRow];const i=this.params;let a="F"+i+"_"+e[t.KeyF],n=t.Descr+", "+e[t.DispField],r=o.FH+"Docfiles/dir?id="+a+"/&caption="+n;this.$refs.fileLink2.href=r,this.$refs.fileLink2.click()},confirmDelete:function(){let t=this.OpenMapData();if(null==t.curRow)return;let e=t.MainTab[t.curRow],i=e[t.DispField];o.uW.confirm(this.Descr,"Удалить запись '"+i+"'?",this.rowDelete)},rowDelete:async function(){let t=this.OpenMapData(),e={};e[t.KeyF]=t.MainTab[t.curRow][t.KeyF],t.DelProc.toLowerCase().indexOf("_del_1")>-1&&(e["AUDTUSER"]=t.Account);const i=o.FH+"React/exec";let a=new FormData;a.append("EditProc",t.DelProc),a.append("SQLParams",JSON.stringify(e)),a.append("KeyF",t.KeyF);const n=await fetch(i,{method:"POST",mode:o.W6?"no-cors":"cors",cache:"no-cache",credentials:o.W6?"include":"omit",body:a}),r=await n.json();"OK"==r.message||"Invalid storage type: DBNull."==r.message?(t.MainTab.splice(t.curRow,1),this.nupdate=this.nupdate+1,null!=o.M8.get(this.id).updateTab&&o.M8.get(this.id).updateTab()):o.uW.alert("Ошибка",r.message)},onChangePage:function(t){this.action=this.action+1,this.OpenMapData().page=t+1,this.updateTab()},updateTab:async function(){const t=o.FH+"React/FinderStart";let e=new FormData,i=this.OpenMapData();const a=this.params;e.append("id",a),e.append("mode","data"),e.append("page",i.page.toString()),e.append("Fc",JSON.stringify(i.Fcols)),i.SQLParams&&e.append("SQLParams",JSON.stringify(i.SQLParams)),i.TextParams&&e.append("TextParams",JSON.stringify(i.TextParams));const n=await fetch(t,{method:"POST",mode:o.W6?"no-cors":"cors",cache:"no-cache",credentials:o.W6?"include":"omit",body:e}),r=await n.json();r.Error?o.uW.alert("Ошибка",r.Error):(i.MainTab=r.MainTab,i.TotalTab=r.TotalTab,i.page=r.page,this.mode,this.mode="grid",this.nupdate=this.nupdate+1,this.openFilter=!1,null!=o.M8.get(this.id).updateTab&&o.M8.get(this.id).updateTab())},saveSetting:function(){let t=this.OpenMapData().Setting,e=t.MainTab[0];t.ColumnTab.map((i=>{e[i]=t.WorkRow[i]}));let i=this.OpenMapData();t.ReferEdit.SaveFieldList.map((e=>{i.SQLParams["@"+e]=t.MainTab[0][e]})),this.updateTab()},save:async function(){let t=this.OpenMapData();for(let o in t.DefaultValues)t.WorkRow[o]=t.DefaultValues[o];for(let o in t.TextParams)t.WorkRow[o]=t.TextParams[o];let e={};t.ReferEdit.SaveFieldList.map((i=>{e[i]=t.WorkRow[i]}));const i=o.FH+"React/exec";let a=new FormData;a.append("EditProc",t.EditProc),a.append("SQLParams",JSON.stringify(e)),a.append("KeyF",t.KeyF);const n=await fetch(i,{method:"POST",mode:o.W6?"no-cors":"cors",cache:"no-cache",credentials:o.W6?"include":"omit",body:a}),r=await n.json();if("OK"!=r.message)return void o.uW.alert("Ошибка",r.message);1==r.ColumnTab.length?t.WorkRow[t.KeyF]=r.MainTab[0][r.ColumnTab[0]]:r.ColumnTab.map((e=>{t.WorkRow[e]=r.MainTab[0][e]}));let s={};if("edit"==this.mode){let e=t.curRow;s=t.MainTab[e]}t.ColumnTab.map((e=>{s[e]=t.WorkRow[e]})),"add"==this.mode&&t.MainTab.push(s),this.mode="grid",this.nupdate=this.nupdate+1,null!=o.M8.get(this.id).updateTab&&o.M8.get(this.id).updateTab()},closeEditor:function(){this.mode="grid"},add:function(){let t=this.OpenMapData();null==t.WorkRow&&(t.WorkRow={}),t.ColumnTab.map((e=>{t.WorkRow[e]=""})),this.nadd=this.nadd+1,this.uid="uid"+this.nadd.toString(),this.mode="add"},edit:function(){let t=this.OpenMapData();null==t.WorkRow&&(t.WorkRow={});let e=t.curRow,i=t.MainTab[e];t.ColumnTab.map((e=>{t.WorkRow[e]=null==i[e]?"":i[e]})),t.Fcols.map((e=>{""!=e.DisplayFormat&&(t.WorkRow[e.FieldName]=this.dateformat(t.WorkRow[e.FieldName],e.DisplayFormat))})),this.nadd=this.nadd+1,this.uid="uid"+this.nadd.toString(),this.mode="edit"},editSetting:function(){let t=this.OpenMapData().Setting;t.WorkRow={};let e=t.MainTab[0];t.ColumnTab.map((i=>{t.WorkRow[i]=null==e[i]?"":e[i]})),t.Fcols.map((e=>{""!=e.DisplayFormat&&(t.WorkRow[e.FieldName]=this.dateformat(t.WorkRow[e.FieldName],e.DisplayFormat))})),this.nadd=this.nadd+1,this.uid2="uid2"+this.nadd.toString(),this.mode="setting"}},mounted:async function(){let t=this.OpenMapData,e=this.OpenMapId,i=this.setLoad;const a=this.editid,n=this.params;if(null!=a){let e=t();return null==e.curRow&&(e.curRow=0),this.current=e.curRow,this.Descr=e.Descr+" (выбор)",e.Fcols.map(((t,i)=>{t.FieldName==e.DispField&&(this.dispIndex=i)})),e.resize=this.resize,window.addEventListener("resize",(function(){e.resize&&e.resize()}),!0),void i(!1)}const r=e();if(r.handleClick=this.handleClick,r.resize=this.resize,null==r.data.Descr){const t=o.FH+"React/FinderStart";let e=new FormData;e.append("id",n),r.SQLParams&&e.append("SQLParams",JSON.stringify(r.SQLParams)),r.TextParams&&e.append("TextParams",JSON.stringify(r.TextParams));const i=await fetch(t,{method:"POST",mode:o.W6?"no-cors":"cors",cache:"no-cache",credentials:o.W6?"include":"omit",body:e});let a=await i.json();if(a.Error)return void o.uW.alert("Ошибка",a.Error);a.curRow=0,a.WorkRow={},a.ColumnTab.map((t=>{a.WorkRow[t]=""})),r.data=a}r.data.Fcols.map(((t,e)=>{t.FieldName==r.data.DispField&&(this.dispIndex=e)})),this.Descr=r.data.Descr,r.title&&(this.Descr=this.Descr+" ("+r.title+")"),this.current=r.data.curRow,i(!1)}};var C=T,W=C,P=i(3237),x=i(7118),E=i(4497),V=i(6816),N=i(7620),j=i(1317),L=i(3249),Z=i(459),I=i(6768),$=(0,c.Z)(W,a,n,!1,null,"331b0b00",null),K=$.exports;p()($,{VBtn:m.Z,VCard:P.Z,VCardActions:x.h7,VCardTitle:x.EB,VDialog:E.Z,VIcon:h.Z,VList:V.Z,VListItem:N.Z,VListItemContent:j.km,VListItemGroup:L.Z,VListItemIcon:Z.Z,VListItemTitle:j.V9,VMenu:I.Z,VSimpleTable:S.Z,VSpacer:f.Z,VTextField:M.Z,VToolbar:v.Z,VToolbarTitle:y.qW})}}]);
//# sourceMappingURL=377.2f49bc35.js.map